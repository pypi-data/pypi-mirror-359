# 📧 创建第一个邮件

这个教程将指导你创建第一个EmailWidget邮件报告。我们将从最简单的例子开始，逐步添加更多功能。

## 🎯 本章目标

- 创建基础邮件对象
- 添加文本、表格、图表等组件
- 导出HTML文件
- 理解链式调用的使用方法

## 🚀 第一步：最简单的邮件

让我们从最简单的例子开始：

```python
from email_widget import Email, TextWidget
from email_widget.enums import TextType

# 创建邮件对象
email = Email("我的第一份报告")

# 添加欢迎文本
email.add_widget(
    TextWidget()
    .set_content("欢迎使用 EmailWidget! 🎉")
    .set_type(TextType.TITLE_LARGE)
)

# 导出HTML文件
file_path = email.export_html("first_email.html")
print(f"邮件已生成: {file_path}")
```

运行这个代码，你会在当前目录下看到一个名为 `first_email.html` 的文件。用浏览器打开它，你将看到一个美观的邮件页面！

!!! success "🎉 恭喜！"
    你已经成功创建了第一个EmailWidget邮件！

## 📝 第二步：添加更多内容

现在让我们添加更多内容，创建一个更完整的报告：

```python
from email_widget import Email, TextWidget, TableWidget, ProgressWidget
from email_widget.enums import TextType, ProgressTheme

# 创建邮件对象，并设置副标题和脚注
email = Email("📊 销售数据周报")
email.set_subtitle("2024年第3周销售情况汇总")
email.set_footer("本报告由销售团队自动生成")

# 1. 添加主标题
email.add_widget(
    TextWidget()
    .set_content("销售业绩概览")
    .set_type(TextType.TITLE_LARGE)
)

# 2. 添加进度指标
email.add_widget(
    ProgressWidget()
    .set_value(85)
    .set_label("本周目标完成率")
    .set_theme(ProgressTheme.SUCCESS)
)

# 3. 添加数据表格
table = TableWidget()
table.set_title("🏆 销售排行榜")
table.set_headers(["销售员", "销售额", "完成率", "状态"])
table.add_row(["张三", "¥125,000", "125%", "success"])
table.add_row(["李四", "¥98,000", "98%", "warning"])
table.add_row(["王五", "¥87,000", "87%", "info"])
email.add_widget(table)

# 4. 添加总结文本
email.add_widget(
    TextWidget()
    .set_content("本周销售业绩整体表现良好，超额完成既定目标。")
    .set_type(TextType.BODY)
)

# 导出HTML文件
file_path = email.export_html("sales_report.html")
print(f"销售报告已生成: {file_path}")
```

## 📊 第三步：添加图表

让我们再添加一个图表，让报告更加生动：

```python
import matplotlib.pyplot as plt
from email_widget import Email, TextWidget, ChartWidget
from email_widget.enums import TextType

# 创建邮件
email = Email("📈 数据分析报告")

# 添加标题
email.add_widget(
    TextWidget()
    .set_content("销售趋势分析")
    .set_type(TextType.TITLE_LARGE)
)

# 创建图表
fig, ax = plt.subplots(figsize=(10, 6))

# 示例数据
months = ['1月', '2月', '3月', '4月', '5月']
sales = [120, 135, 148, 162, 185]

# 绘制图表
ax.plot(months, sales, marker='o', linewidth=3, markersize=8)
ax.set_title('月度销售趋势', fontsize=16, fontweight='bold')
ax.set_ylabel('销售额 (万元)', fontsize=12)
ax.set_xlabel('月份', fontsize=12)
ax.grid(True, alpha=0.3)

# 设置图表样式
ax.set_facecolor('#f8f9fa')
plt.tight_layout()

# 添加图表到邮件
email.add_widget(
    ChartWidget()
    .set_chart(plt)
    .set_title("📊 销售趋势图")
    .set_description("显示了过去5个月的销售增长趋势")
    .set_data_summary("平均增长率: 11.2%，预计下月销售额: 205万元")
)

# 导出HTML文件
file_path = email.export_html("trend_report.html")
print(f"趋势报告已生成: {file_path}")
```

!!! tip "💡 字体提示"
    如果图表中的中文显示不正常，EmailWidget会自动处理字体配置。如果仍有问题，请确保系统安装了中文字体。

## 🔗 第四步：使用链式调用

EmailWidget支持链式调用，让代码更加简洁优雅：

```python
from email_widget import Email, TextWidget, AlertWidget
from email_widget.enums import TextType, AlertType

# 使用链式调用创建完整邮件
email = (Email("⚡ 快捷报告")
         .set_subtitle("使用链式调用创建")
         .set_footer("Generated by EmailWidget")
         .add_widget(
             TextWidget()
             .set_content("系统状态报告")
             .set_type(TextType.TITLE_LARGE)
         )
         .add_widget(
             AlertWidget()
             .set_content("所有系统运行正常，无异常情况。")
             .set_alert_type(AlertType.TIP)
             .set_title("状态更新")
         ))

# 导出
file_path = email.export_html("chain_report.html")
print(f"链式调用报告已生成: {file_path}")
```

## 🎨 第五步：自定义样式

你还可以自定义邮件的样式：

```python
from email_widget import Email, TextWidget
from email_widget.core.config import EmailConfig
from email_widget.enums import TextType

# 创建自定义配置
config = EmailConfig()
config.set_theme_color("#FF6B6B")  # 设置主题色
config.set_font_family("Arial, sans-serif")  # 设置字体

# 创建邮件并应用配置
email = Email("🎨 自定义样式报告")
email.config = config

# 添加内容
email.add_widget(
    TextWidget()
    .set_content("这是一个自定义样式的报告")
    .set_type(TextType.TITLE_LARGE)
)

# 导出
file_path = email.export_html("custom_style_report.html")
print(f"自定义样式报告已生成: {file_path}")
```

## 📱 第六步：便捷方法

EmailWidget提供了一些便捷方法，让常见操作更简单：

```python
from email_widget import Email

# 创建邮件
email = Email("📋 便捷方法演示")

# 使用便捷方法添加内容
email.add_text("项目进展报告", text_type="title_large")
email.add_text("本周完成了以下重要工作：", text_type="section_h2")

# 直接从数据创建表格
data = [
    ["任务", "负责人", "状态"],
    ["UI设计", "张设计", "已完成"],
    ["后端开发", "李程序", "进行中"],
    ["测试工作", "王测试", "待开始"]
]
email.add_table_from_data(data, title="任务进度表")

# 添加进度条
email.add_progress(value=75, label="项目整体进度")

# 导出
file_path = email.export_html("convenient_methods.html")
print(f"便捷方法报告已生成: {file_path}")
```

## 🔍 查看结果

每次运行代码后，生成的HTML文件都可以：

1. **用浏览器打开** - 直接双击HTML文件
2. **嵌入网页** - 复制HTML代码到网页中
3. **作为邮件内容** - 复制HTML用于邮件客户端
4. **打印或保存** - 浏览器支持打印和保存为PDF

## 🎯 小结

通过这个教程，你学会了：

- ✅ 创建基础的Email对象
- ✅ 添加各种Widget组件（文本、表格、图表等）
- ✅ 使用链式调用编写优雅的代码
- ✅ 自定义邮件样式和配置
- ✅ 使用便捷方法快速构建内容
- ✅ 导出和查看HTML邮件文件

## 🚀 下一步

现在你已经掌握了基础用法，可以继续学习：

- [基本概念](concepts.md) - 深入理解EmailWidget的设计理念
- [用户指南](../user-guide/index.md) - 学习所有组件的详细用法
- [示例代码](../examples/index.md) - 查看更多实际应用场景

---

!!! question "遇到问题？"
    
    如果在创建第一个邮件时遇到任何问题，可以：
    
    - 查看 [常见问题](faq.md)
    - 在 [GitHub Issues](https://github.com/271374667/SpiderDaily/issues) 提问
    - 参考 [API文档](../api/index.md) 了解详细用法 