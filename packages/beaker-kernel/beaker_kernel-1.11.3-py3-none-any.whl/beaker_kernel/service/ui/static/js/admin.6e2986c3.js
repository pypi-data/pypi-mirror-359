var beaker_vue;(function(){var e={82216:function(e,t,a){"use strict";a.r(t);var n=a(31601),r=a.n(n),o=a(76314),l=a.n(o),i=l()(r());i.push([e.id,"#app{margin:.5rem}.header{display:flex;align-items:center;padding-right:.4rem;gap:.2rem}.header-title{font-size:xx-large;font-weight:bolder}.stats{margin-bottom:3rem;gap:4rem}.p-datatable{border:1px solid var(--surface-border)}.stats-tables{display:flex;flex-direction:row;gap:2rem}.selection-column{text-align:center}.selection-column .p-column-header-content{justify-content:center}.expansion-column{padding:0;padding-left:.5rem;text-align:center}.context-config{white-space:pre;font-family:monospace;font-size:90%;background-color:#e1e1e1;border-radius:6px;border:1px solid #aaa;color:inherit;padding:.5rem;overflow:auto}.p-datatable .p-datatable-tbody>tr>td{vertical-align:top;padding-top:1.25rem}.p-datatable .p-datatable-tbody>tr>td.expansion-column{padding-top:1rem}tr.p-highlight{color:#000}tr.p-row-odd{background-color:#f0f0f0}tr.p-row-odd.p-highlight{background-color:#d0d0f0}tr.p-datatable-row-expansion{background-color:#ddd}",""]),t["default"]=i},85958:function(e,t,a){var n=a(82216);n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.id,n,""]]),n.locals&&(e.exports=n.locals);var r=a(68459).A;r("63fd1544",n,!0,{sourceMap:!1,shadowMode:!1})},90719:function(e,t,a){"use strict";var n=a(45130),r=a(99119),o=(a(18111),a(61701),a(56768)),l=a(90144),i=a(24232),s=a(47997),d=a(80257),u=a(42775),c=a(66846),f=a(44371),p=a(86659),b=a(3598),v=a(40141),h=a(42151);const k={id:"admin"},m={style:{"margin-right":"3rem",display:"flex","justify-content":"right","justify-items":"center"}},g={style:{"margin-top":"auto","margin-bottom":"auto","font-weight":"bolder","font-size":"larger"}},y={class:"stats"},_={class:"stats-tables"},F={class:"header"},R={style:{"font-size":"large"}},A={class:"context-config"};var x=(0,o.pM)({__name:"BeakerAdmin",props:["config"],setup(e){const t=(0,v.S)(),a=(0,h.d)(),n=s.PageConfig.getBaseUrl(),r=(0,l.KR)({}),x=(0,l.KR)(),L=(0,l.KR)("never"),w=(0,l.KR)("---"),j=(0,l.KR)([]),C=(0,l.KR)([]),O=(0,o.EW)((()=>{const e=r.value.sessions?.map((e=>({session_id:e.path,raw_id:e.id,kernel:e.kernel,subkernel:e.subkernel,last_active:e.kernel.last_activity,idle:((Date.now()-Date.parse(e.kernel.last_activity))/6e4).toFixed(2),connected:e.kernel.connections>0,process_info:e.process_info,context:e.kernel.context?.name,context_config:e.kernel.context?.config})));return e})),U=(0,o.EW)((()=>C.value.map((e=>e.session_id)))),P=async()=>{const e=s.URLExt.join(n,"/stats"),t=await fetch(e);r.value=await t.json(),L.value=(new Date).toUTCString()},E=async e=>{for(const t of e){const e=s.URLExt.join(n,"/api/sessions/",t),o=await fetch(e,{method:"DELETE",headers:{Authorization:`token ${r.value.token}`}});if(!o.ok){const e=await o.text();a.add({severity:"error",summary:"Error removing session",detail:`${o.status} ${o.statusText} - ${e}`,life:3e3})}}await P()},M=()=>{0!==j.value.length&&"---"!==w.value&&"destroy"===w.value&&S(j.value)},S=e=>{t.require({message:`Are you sure you want to proceed? This will destroy session(s): ${e.map((e=>e.session_id)).join(", ")}`,header:"Confirmation",icon:"pi pi-exclamation-triangle",rejectClass:"p-button-secondary p-button-outlined",rejectLabel:"Cancel",acceptLabel:"Confirm",accept:async()=>{await E(e.map((e=>e.raw_id)))},reject:()=>{}})};return(0,o.KC)((()=>{P(),x.value=window.setInterval(P,6e4)})),(0,o.xo)((()=>{clearInterval(x.value)})),(e,t)=>((0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)((0,l.R1)(f.A)),(0,o.Lk)("div",k,[(0,o.Lk)("div",null,[t[4]||(t[4]=(0,o.Lk)("h1",{style:{"text-align":"center"}},"Beaker admin",-1)),(0,o.Lk)("div",m,[(0,o.Lk)("span",g,"Last updated: "+(0,i.v_)(L.value),1),(0,o.bF)((0,l.R1)(u.A),{icon:"pi pi-refresh",style:{"margin-left":"1rem"},raised:"",onClick:t[0]||(t[0]=e=>P())})])]),(0,o.Lk)("div",y,[t[9]||(t[9]=(0,o.Lk)("h2",null,"Stats",-1)),(0,o.Lk)("div",_,[(0,o.bF)((0,l.R1)(d.A),{value:[r.value.file_handles]},{header:(0,o.k6)((()=>t[5]||(t[5]=[(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("span",{class:"header-title"},"File Handles")],-1)]))),default:(0,o.k6)((()=>[(0,o.bF)((0,l.R1)(c.A),{field:"open",header:"Open"}),(0,o.bF)((0,l.R1)(c.A),{field:"total",header:"Total"}),(0,o.bF)((0,l.R1)(c.A),{field:"usage",header:"Usage"})])),_:1},8,["value"]),(0,o.bF)((0,l.R1)(d.A),{value:[r.value.load]},{header:(0,o.k6)((()=>t[6]||(t[6]=[(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("span",{class:"header-title"},"Load")],-1)]))),default:(0,o.k6)((()=>[(0,o.bF)((0,l.R1)(c.A),{field:"1_min",header:"1 Min"}),(0,o.bF)((0,l.R1)(c.A),{field:"5_min",header:"5 Min"}),(0,o.bF)((0,l.R1)(c.A),{field:"15_min",header:"15 Min"})])),_:1},8,["value"]),(0,o.bF)((0,l.R1)(d.A),{value:[r.value.memory]},{header:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("span",{class:"header-title"},"Memory")],-1)]))),default:(0,o.k6)((()=>[(0,o.bF)((0,l.R1)(c.A),{field:"total",header:"Total"}),(0,o.bF)((0,l.R1)(c.A),{field:"used",header:"Used"}),(0,o.bF)((0,l.R1)(c.A),{field:"free",header:"Free"}),(0,o.bF)((0,l.R1)(c.A),{field:"usage",header:"Usage"})])),_:1},8,["value"]),(0,o.bF)((0,l.R1)(d.A),{value:[r.value.disk]},{header:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.Lk)("div",{class:"header"},[(0,o.Lk)("span",{class:"header-title"},"Disk")],-1)]))),default:(0,o.k6)((()=>[(0,o.bF)((0,l.R1)(c.A),{field:"total",header:"Total"}),(0,o.bF)((0,l.R1)(c.A),{field:"used",header:"Used"}),(0,o.bF)((0,l.R1)(c.A),{field:"free",header:"Free"}),(0,o.bF)((0,l.R1)(c.A),{field:"usage",header:"Usage"})])),_:1},8,["value"])])]),(0,o.Lk)("div",null,[t[22]||(t[22]=(0,o.Lk)("h2",null,"Sessions",-1)),(0,o.bF)((0,l.R1)(d.A),{value:O.value,selection:j.value,"onUpdate:selection":t[2]||(t[2]=e=>j.value=e),"expanded-rows":C.value,"onUpdate:expandedRows":t[3]||(t[3]=e=>C.value=e),"striped-rows":!0,removableSort:""},{header:(0,o.k6)((()=>[(0,o.Lk)("div",F,[t[11]||(t[11]=(0,o.Lk)("span",{class:"header-title"},"Sessions",-1)),t[12]||(t[12]=(0,o.Lk)("span",{style:{flex:"100"}},null,-1)),(0,o.Lk)("span",R,"Session count: "+(0,i.v_)(r.value.sessions?.length||0),1),t[13]||(t[13]=(0,o.Lk)("span",{style:{padding:"0 1rem"}}," | ",-1)),(0,o.bF)((0,l.R1)(p.A),{options:["---","destroy"],modelValue:w.value,"onUpdate:modelValue":t[1]||(t[1]=e=>w.value=e)},null,8,["modelValue"]),(0,o.bF)((0,l.R1)(u.A),{severity:"success",raised:"",onClick:M},{default:(0,o.k6)((()=>t[10]||(t[10]=[(0,o.eW)("Go")]))),_:1})])])),expansion:(0,o.k6)((({data:e})=>[(0,o.Lk)("div",null,[t[21]||(t[21]=(0,o.Lk)("h4",null,[(0,o.eW)("Process details "),(0,o.Lk)("span",{style:{"font-size":"smaller","margin-left":"3rem"}},"(Note: CPU and Memory usage may be reflected mulitple times due to parent/child relational reporting)")],-1)),(0,o.bF)((0,l.R1)(d.A),{value:e.process_info,"striped-rows":!0,removableSort:""},{default:(0,o.k6)((()=>[(0,o.bF)((0,l.R1)(c.A),{field:"pid",header:"PID",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"ppid",header:"Parent PID",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"cpu_pct",header:"CPU Usage %",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"cputime",header:"Cumulative CPU Time",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"mem_pct",header:"Mem Usage (%)",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"mem_bytes",header:"Mem Usage (bytes)",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"threads",header:"Thread count",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"open_files",header:"File handles",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"cmd",header:"Full command",sortable:""})])),_:2},1032,["value"])])])),default:(0,o.k6)((()=>[(0,o.bF)((0,l.R1)(c.A),{class:"selection-column","selection-mode":"multiple"}),(0,o.bF)((0,l.R1)(c.A),{class:"expansion-column",expander:""}),(0,o.bF)((0,l.R1)(c.A),{field:"kernel.id",header:"Beaker Kernel",sortable:""},{body:(0,o.k6)((({data:e})=>[(0,o.Lk)("div",null,(0,i.v_)(e.session_id),1),U.value.includes(e.session_id)?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[t[15]||(t[15]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("div",null,[t[14]||(t[14]=(0,o.Lk)("span",{style:{"font-weight":"bold"}},"Kernel ID:",-1)),(0,o.eW)(" "+(0,i.v_)(e.kernel.id),1)])],64)):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)((0,l.R1)(c.A),{header:"Subkernel",field:"subkernel.id",sortable:""},{body:(0,o.k6)((({data:e})=>[(0,o.Lk)("div",null,(0,i.v_)(e.subkernel.id),1),U.value.includes(e.session_id)?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[t[17]||(t[17]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("div",null,[t[16]||(t[16]=(0,o.Lk)("span",{style:{"font-weight":"bold"}},"Type:",-1)),(0,o.eW)(" "+(0,i.v_)(e.subkernel.name),1)])],64)):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)((0,l.R1)(c.A),{header:"Current Context",field:"context",sortable:""},{body:(0,o.k6)((({data:e})=>[(0,o.Lk)("div",null,(0,i.v_)(e.context),1),U.value.includes(e.session_id)?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[t[18]||(t[18]=(0,o.Lk)("br",null,null,-1)),t[19]||(t[19]=(0,o.Lk)("span",{style:{"font-weight":"bold"}},"Config:",-1)),t[20]||(t[20]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("div",A,(0,i.v_)(e.context_config),1)],64)):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)((0,l.R1)(c.A),{field:"last_active",header:"Last Active",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"idle",header:"Idle Duration (min)",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{field:"connected",header:"User connected",sortable:""}),(0,o.bF)((0,l.R1)(c.A),{header:"Destroy"},{body:(0,o.k6)((({data:e})=>[(0,o.bF)((0,l.R1)(u.A),{style:{height:"2rem",width:"2rem","text-align":"center"},icon:"pi pi-times",severity:"danger",raised:"",onClick:t=>S([{session_id:e.session_id,raw_id:e.raw_id}])},null,8,["onClick"])])),_:1})])),_:1},8,["value","selection","expanded-rows"])])]),(0,o.bF)((0,l.R1)(b.A),{position:"bottom-right"})],64))}});a(85958);const L=x;var w=L,j=a(18648),C=a(26883),O=a(8271),U=a(85413);a(96153);const P=s.PageConfig.getBaseUrl();(async()=>{const e=s.URLExt.join(P,"/config"),t=await fetch(e),a=await t.json(),o=(0,n.Ef)(w,{config:a});o.use(r.Ay),o.use(C.A),o.use(U.A),o.directive("tooltip",j.A),o.directive("focustrap",O.A),o.mount("#app")})()}},t={};function a(n){var r=t[n];if(void 0!==r)return r.exports;var o=t[n]={id:n,exports:{}};return e[n].call(o.exports,o,o.exports,a),o.exports}a.m=e,function(){var e=[];a.O=function(t,n,r,o){if(!n){var l=1/0;for(u=0;u<e.length;u++){n=e[u][0],r=e[u][1],o=e[u][2];for(var i=!0,s=0;s<n.length;s++)(!1&o||l>=o)&&Object.keys(a.O).every((function(e){return a.O[e](n[s])}))?n.splice(s--,1):(i=!1,o<l&&(l=o));if(i){e.splice(u--,1);var d=r();void 0!==d&&(t=d)}}return t}o=o||0;for(var u=e.length;u>0&&e[u-1][2]>o;u--)e[u]=e[u-1];e[u]=[n,r,o]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};a.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"===typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"===typeof n.then)return n}var o=Object.create(null);a.r(o);var l={};e=e||[null,t({}),t([]),t(t)];for(var i=2&r&&n;"object"==typeof i&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((function(e){l[e]=function(){return n[e]}}));return l["default"]=function(){return n},a.d(o,l),o}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.e=function(){return Promise.resolve()}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.j=884}(),function(){a.p="/"}(),function(){a.b=document.baseURI||self.location.href;var e={884:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var r,o,l=n[0],i=n[1],s=n[2],d=0;if(l.some((function(t){return 0!==e[t]}))){for(r in i)a.o(i,r)&&(a.m[r]=i[r]);if(s)var u=s(a)}for(t&&t(n);d<l.length;d++)o=l[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(u)},n=self["webpackChunkbeaker_vue"]=self["webpackChunkbeaker_vue"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(90719)}));n=a.O(n),beaker_vue=n})();
//# sourceMappingURL=admin.6e2986c3.js.map