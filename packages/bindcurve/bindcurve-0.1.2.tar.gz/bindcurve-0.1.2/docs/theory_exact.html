<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Exact Kd models – BindCurve</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./images/logo3.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">BindCurve</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://github.com/choutkaj/bindcurve"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text">GitHub</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./theory_logistic.html"><strong>Theory</strong></a></li><li class="breadcrumb-item"><a href="./theory_exact.html">Exact Kd models</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>How to use</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./getting_started.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Getting started</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./input_format.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Input format</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Models</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Tutorials</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials/basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Basics</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials/Kd_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exact Kd models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tutorials/plotting_components.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting system components</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text"><strong>Theory</strong></span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theory_logistic.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Logistic models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theory_exact.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Exact Kd models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./theory_conversions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">IC50-&gt;Kd conversion</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./symbols.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>Symbols</strong></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./reference/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><strong>API reference</strong></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#direct-binding" id="toc-direct-binding" class="nav-link active" data-scroll-target="#direct-binding">Direct binding</a>
  <ul class="collapse">
  <li><a href="#direct-binding---simplified" id="toc-direct-binding---simplified" class="nav-link" data-scroll-target="#direct-binding---simplified">Direct binding - simplified</a></li>
  <li><a href="#direct-binding---specific" id="toc-direct-binding---specific" class="nav-link" data-scroll-target="#direct-binding---specific">Direct binding - specific</a></li>
  <li><a href="#direct-binding---total" id="toc-direct-binding---total" class="nav-link" data-scroll-target="#direct-binding---total">Direct binding - total</a></li>
  </ul></li>
  <li><a href="#complete-competitive-binding-three-state-models" id="toc-complete-competitive-binding-three-state-models" class="nav-link" data-scroll-target="#complete-competitive-binding-three-state-models">Complete competitive binding (three-state models)</a>
  <ul class="collapse">
  <li><a href="#complete-competitive-binding---specific" id="toc-complete-competitive-binding---specific" class="nav-link" data-scroll-target="#complete-competitive-binding---specific">Complete competitive binding - specific</a></li>
  <li><a href="#complete-competitive-binding---total" id="toc-complete-competitive-binding---total" class="nav-link" data-scroll-target="#complete-competitive-binding---total">Complete competitive binding - total</a></li>
  </ul></li>
  <li><a href="#incomplete-competitive-binding-four-state-models" id="toc-incomplete-competitive-binding-four-state-models" class="nav-link" data-scroll-target="#incomplete-competitive-binding-four-state-models">Incomplete competitive binding (four-state models)</a>
  <ul class="collapse">
  <li><a href="#incomplete-competitive-binding---specific" id="toc-incomplete-competitive-binding---specific" class="nav-link" data-scroll-target="#incomplete-competitive-binding---specific">Incomplete competitive binding - specific</a></li>
  <li><a href="#incomplete-competitive-binding---total" id="toc-incomplete-competitive-binding---total" class="nav-link" data-scroll-target="#incomplete-competitive-binding---total">Incomplete competitive binding - total</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./theory_logistic.html"><strong>Theory</strong></a></li><li class="breadcrumb-item"><a href="./theory_exact.html">Exact Kd models</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Exact Kd models</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>BindCurve implements several exact models that allow for direct fitting of <span class="math inline">\(K_d\)</span> from both direct and competitive binding experiments, given some crucial informations about the system are known. These models are based on the assumption that the observed binding curve could be related to the bound fraction of the labeled ligand. This quantity is denoted as <span class="math inline">\(F_b^*\)</span> and is defined as:</p>
<p><span class="math display">\[
F_b^* = \frac{[RL^*]}{[L^*]_T}
\]</span></p>
<p>where <span class="math inline">\([RL^*]\)</span> is the concentration of the complex of receptor and labeled ligand, and <span class="math inline">\([L^*]_T\)</span> is the total concentration of the labeled ligand.</p>
<section id="direct-binding" class="level2">
<h2 class="anchored" data-anchor-id="direct-binding">Direct binding</h2>
<p>What function to use: <code>fit_Kd_direct</code></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/direct_frame.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:30.0%" alt="Direct binding."></p>
</figure>
</div>
<p>In direct binding, the system is composed of receptor <span class="math inline">\(R\)</span> and labeled ligand <span class="math inline">\(L^*\)</span> which form complex <span class="math inline">\(RL^*\)</span>. This binding equilibrium is described by a dissociation constant <span class="math inline">\(K_d^*\)</span>. For such a system, <span class="math inline">\(F_b^*\)</span> could be related to the concentration of free receptor <span class="math inline">\([R]\)</span> by the equation</p>
<p><span class="math display">\[
F_b^* = \frac{[RL^*]}{[L^*]_T} = \frac{[R]}{K_d^* + [R]}
\]</span></p>
<p>To allow for a proper description of the dependent variable, the general framework for direct binding is defined as</p>
<p><span class="math display">\[
y = ymin + (ymax - ymin) \frac{[R]}{K_d^* + [R]}
\]</span></p>
<section id="direct-binding---simplified" class="level3">
<h3 class="anchored" data-anchor-id="direct-binding---simplified">Direct binding - simplified</h3>
<p>Model name: <code>dir_simple</code></p>
<p>In this simplified model, the concentration of the free receptor <span class="math inline">\([R]\)</span> is approximated by the total concentration of the receptor <span class="math inline">\([R]_T\)</span>. Thus, <span class="math inline">\([R]\)</span> is simply given as: <span class="math display">\[
[R] = [R]_T
\]</span></p>
</section>
<section id="direct-binding---specific" class="level3">
<h3 class="anchored" data-anchor-id="direct-binding---specific">Direct binding - specific</h3>
<p>Model name: <code>dir_specific</code></p>
<p>To properly describe direct binding beyond the simplified approximation above, let us look at an exact model. The dissociation constant <span class="math inline">\(K_d^*\)</span> is defined as: <span class="math display">\[
K_d^* = \frac{[R][L^*]}{[RL^*]}
\]</span></p>
<p>Conservation of mass requires that: <span class="math display">\[
[L^* ]_T = [L^*] + [RL^*]
\]</span> <span class="math display">\[
[R]_T = [R] + [RL^*]
\]</span></p>
<p>where <span class="math inline">\([R]_T\)</span> is the total concentration of the receptor and <span class="math inline">\([L^*]\)</span> is the concentration of free labeled ligand. Thus, <span class="math inline">\([RL^*]\)</span> is calculated as: <span class="math display">\[
[RL^*] = \frac{[R] [L^* ]_T}{K_d^* + [R]}
\]</span></p>
<p>From the equations above, <span class="math inline">\([R]\)</span> can be expressed in a quadratic equation: <span class="math display">\[
[R]^2 + a[R] + b = 0
\]</span></p>
<p>where the coefficients are calculated as: <span class="math display">\[
a = K_d^* + [L^*]_T - [R]_T
\]</span> <span class="math display">\[
b = -K_d^* [R]_T
\]</span></p>
<p>The physical solution for <span class="math inline">\([R]\)</span> is calculated as the positive root using the quadratic formula:</p>
<p><span class="math display">\[
[R] = \frac{-a + \sqrt{a^2 - 4b}}{2}
\]</span></p>
</section>
<section id="direct-binding---total" class="level3">
<h3 class="anchored" data-anchor-id="direct-binding---total">Direct binding - total</h3>
<p>Model name: <code>dir_total</code></p>
<p>Nonspecific binding (immobilization) of the labeled ligand <span class="math inline">\(L^*\)</span> can be modeled by introducing a dimensionless, non-negative parameter <span class="math inline">\(N^*\)</span>. In this case, the dissociation constant <span class="math inline">\(K_d^*\)</span> is defined in the same way as above: <span class="math display">\[
K_d^* = \frac{[R][L^*]}{[RL^*]}
\]</span></p>
<p>Now, the conservation of mass requires that: <span class="math display">\[
[L^* ]_T = [L^*] + [RL^*] + N^*[L^*]
\]</span> <span class="math display">\[
[R]_T = [R] + [RL^*]
\]</span></p>
<p>Thus, <span class="math inline">\([RL^*]\)</span> is calculated as: <span class="math display">\[
[RL^*] = \frac{[R][L^*]_T}{K_d^*(1+N^*) + [R]}
\]</span></p>
<p>Again, <span class="math inline">\([R]\)</span> can be expressed in a quadratic equation: <span class="math display">\[
[R]^2 + a[R] + b = 0
\]</span></p>
<p>where the coefficients are calculated as: <span class="math display">\[
a = K_d^*(1+N^*) + [L^*]_T - [R]_T
\]</span> <span class="math display">\[
b = -K_d^*[R]_T(1+N^*)
\]</span></p>
<p>The physical solution for <span class="math inline">\([R]\)</span> is again calculated using the quadratic formula: <span class="math display">\[
[R] = \frac{-a + \sqrt{a^2 - 4b}}{2}
\]</span></p>
<p>Clearly, the introduction of <span class="math inline">\(N^*\)</span> leads to a model where the dissociation constant <span class="math inline">\(K_d^*\)</span> is scaled by a factor of <span class="math inline">\((1+N^*)\)</span>. Thus, the total binding is modeled as specific binding defined by <span class="math inline">\(K_d^*\)</span> and a nonspecific binding scaling term depending on <span class="math inline">\(N^*\)</span>. For example, if we consider <span class="math inline">\(N^* = 0.5\)</span>, the resulting effective dissociation constant for total binding in this model would be <span class="math inline">\(1.5K_d^*\)</span> (total binding would be 150% of the specific binding). Finally, if <span class="math inline">\(N^* = 0\)</span> (there is no nonspecific binding), the model collapses to the case for specific binding only.</p>
</section>
</section>
<section id="complete-competitive-binding-three-state-models" class="level2">
<h2 class="anchored" data-anchor-id="complete-competitive-binding-three-state-models">Complete competitive binding (three-state models)</h2>
<p>What function to use: <code>fit_Kd_competition</code></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/competitive_3st_frame.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%" alt="Competitive binding (three-state)."></p>
</figure>
</div>
<p>In three-state models, the system is composed of receptor <span class="math inline">\(R\)</span>, labeled ligand <span class="math inline">\(L^*\)</span>, and unlabeled ligand <span class="math inline">\(L\)</span>. The formation of complex <span class="math inline">\(RL^*\)</span> is described by a dissociation constant <span class="math inline">\(K_d^*\)</span>, while the formation of complex <span class="math inline">\(RL\)</span> is described by a dissociation constant <span class="math inline">\(K_d\)</span>. For such a system, <span class="math inline">\(F_b^*\)</span> could be related to the concentration of free receptor <span class="math inline">\([R]\)</span> by the equation</p>
<p><span class="math display">\[
F_b^* = \frac{[RL^*]}{[L^*]_T} = \frac{[R]}{K_d + [R]}
\]</span></p>
<p>To allow for a proper description of the dependent variable, the general framework for competitive binding is defined as</p>
<p><span class="math display">\[
y = ymin + (ymax - ymin) \frac{[R]}{K_d + [R]}
\]</span></p>
<section id="complete-competitive-binding---specific" class="level3">
<h3 class="anchored" data-anchor-id="complete-competitive-binding---specific">Complete competitive binding - specific</h3>
<p>Model name: <code>comp_3st_specific</code><br>
References: <a href="https://doi.org/10.1016/0014-5793(95)00062-E">Wang 1995</a>, <a href="https://doi.org/10.1021/bi048233g">Roehrl 2004</a></p>
<p>Dissociation constants in the three-state model are defined as:</p>
<p><span class="math display">\[
K_d^* = \frac{[R][L^*]}{[RL^*]}
\]</span></p>
<p><span class="math display">\[
K_d = \frac{[R][L]}{[RL]}
\]</span></p>
<p>Conservation of mass requires that:</p>
<p><span class="math display">\[
[L^* ]_T = [L^*] + [RL^*]
\]</span></p>
<p><span class="math display">\[
[L]_T = [L] + [RL]
\]</span></p>
<p><span class="math display">\[
[R]_T = [R] + [RL^*] + [RL]
\]</span></p>
<p>Thus, the concentrations of the complexes are calculated as:</p>
<p><span class="math display">\[
[RL] = \frac{[R][L]_T}{K_d + [R]}
\]</span></p>
<p><span class="math display">\[
[RL^*] = \frac{[R][L^*]_T}{K_d^* + [R]}
\]</span></p>
<p>From the above equations, <span class="math inline">\([R]\)</span> can be expressed in a cubic equation:</p>
<p><span class="math display">\[
[R]^3 + a[R]^2 + b[R] + c = 0
\]</span></p>
<p>Where the coefficients are calculated as:</p>
<p><span class="math display">\[
a = K_d^* + K_d + [L^*]_T + [L]_T - [R]_T
\]</span></p>
<p><span class="math display">\[
b = K_d^*([L]_T - [R]_T) + K_d([L^*]_T - [R]_T) + K_d^* K_d
\]</span></p>
<p><span class="math display">\[
c = - K_d^* K_d [R]_T
\]</span></p>
<p>The physical solution for <span class="math inline">\([R]\)</span> can be calculated analytically using the equation:</p>
<p><span class="math display">\[
[R] = -\frac{a}{3} + \frac{2}{3} \sqrt{(a^2 - 3b)} \cos\left(\frac{\theta}{3}\right)
\]</span></p>
<p>The concentrations of both complexes are calculated as:</p>
<p><span class="math display">\[
[RL^*] = \frac{[L^*]_T \left(2 \sqrt{(a^2 - 3b)} \cos\left(\frac{\theta}{3}\right) - a\right)}{3K_d^* + \left(2 \sqrt{(a^2 - 3b)} \cos\left(\frac{\theta}{3}\right) - a\right)}
\]</span></p>
<p><span class="math display">\[
[RL] = \frac{[L]_T \left(2 \sqrt{(a^2 - 3b)} \cos\left(\frac{\theta}{3}\right) - a\right)}{3K_d + \left(2 \sqrt{(a^2 - 3b)} \cos\left(\frac{\theta}{3}\right) - a\right)}
\]</span></p>
<p>The angle <span class="math inline">\(\theta\)</span> is defined as:</p>
<p><span class="math display">\[
\theta = \arccos\left(\frac{-2a^3 + 9ab - 27c}{2 \sqrt{(a^2 - 3b)^3}}\right)
\]</span></p>
</section>
<section id="complete-competitive-binding---total" class="level3">
<h3 class="anchored" data-anchor-id="complete-competitive-binding---total">Complete competitive binding - total</h3>
<p>Model name: <code>comp_3st_total</code><br>
References: <a href="https://doi.org/10.1021/bi048233g">Roehrl 2004</a></p>
<p>Nonspecific binding of the unlabeled ligand can be modeled by introducing a dimensionless, non-negative parameter <span class="math inline">\(N\)</span>. In such case, the dissociation constants <span class="math inline">\(K_d^*\)</span> and <span class="math inline">\(K_d\)</span> are defined the same way as above, and the conservation of mass now requires that:</p>
<p><span class="math display">\[
[L^* ]_T = [L^*] + [RL^*]
\]</span></p>
<p><span class="math display">\[
[L]_T = [L] + [RL] + N[L]
\]</span></p>
<p><span class="math display">\[
[R]_T = [R] + [RL^*] + [RL]
\]</span></p>
<p>From the above equations, <span class="math inline">\([R]\)</span> can again be expressed in a cubic equation:</p>
<p><span class="math display">\[
[R]^3 + a[R]^2 + b[R] + c = 0
\]</span></p>
<p>Where the coefficients are calculated as:</p>
<p><span class="math display">\[
a = K_d^* + (1+N)K_d + [L^* ]_T + [L]_T - [R]_T
\]</span> <span class="math display">\[
b = K_d^* ([L]_T - [R]_T) + (1+N)K_d ([L^* ]_T - [R]_T) + (1+N)K_d^* K_d
\]</span> <span class="math display">\[
c = -(1+N) K_d^* K_d [R]_T
\]</span></p>
<p>The physical solution for <span class="math inline">\([R]\)</span> can be calculated analytically using the same set of equations as above. Analogous to the direct binding case, the introduction of <span class="math inline">\(N\)</span> leads to a model where <span class="math inline">\(K_d\)</span> is scaled by a factor of <span class="math inline">\((1+N)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In models of competitive binding, the nonspecific binding of the labeled ligand (<span class="math inline">\(N^*\)</span>) is neglected as it is assumed that labeled ligands with significant nonspecific immobilization would not be used for such experiments.</p>
</div>
</div>
</section>
</section>
<section id="incomplete-competitive-binding-four-state-models" class="level2">
<h2 class="anchored" data-anchor-id="incomplete-competitive-binding-four-state-models">Incomplete competitive binding (four-state models)</h2>
<p>What function to use: <code>fit_Kd_competition</code></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/competitive_4st_frame.svg" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:40.0%" alt="Competitive binding (four-state)."></p>
</figure>
</div>
<p>In four-state models, the system is also composed of receptor <span class="math inline">\(R\)</span>, labeled ligand <span class="math inline">\(L^*\)</span>, and unlabeled ligand <span class="math inline">\(L\)</span>. However, in addition to complexes <span class="math inline">\(RL^*\)</span> and <span class="math inline">\(RL\)</span>, a ternary complex <span class="math inline">\(RLL^*\)</span> is also considered. The dissociation constants <span class="math inline">\(K_d^*\)</span> and <span class="math inline">\(K_d\)</span> are defined as in the three-state model, and the formation of <span class="math inline">\(RLL^*\)</span> from <span class="math inline">\(RL\)</span> and <span class="math inline">\(L^*\)</span> is described by dissociation constant <span class="math inline">\(K_{d3}\)</span>. The constant <span class="math inline">\(K_{d4}\)</span> is not used in the model.<br>
For the four-state models, <span class="math inline">\(F_b^*\)</span> and the general framework of the model stay the same as for three-state systems and is written as</p>
<p><span class="math display">\[
F_b^* = \frac{[RL^*]}{[L^*]_T} = \frac{[R]}{K_d + [R]}
\]</span></p>
<p><span class="math display">\[
y = ymin + (ymax - ymin) \frac{[R]}{K_d + [R]}
\]</span></p>
<section id="incomplete-competitive-binding---specific" class="level3">
<h3 class="anchored" data-anchor-id="incomplete-competitive-binding---specific">Incomplete competitive binding - specific</h3>
<p>Model name: <code>comp_4st_specific</code><br>
References: <a href="https://doi.org/10.1021/bi048233g">Roehrl 2004</a></p>
<p>Dissociation constants in the four-state model are defined as:</p>
<p><span class="math display">\[
K_d^* = \frac{[R][L^*]}{[RL^*]}  
\]</span></p>
<p><span class="math display">\[
K_d = \frac{[R][L]}{[RL]}  
\]</span></p>
<p><span class="math display">\[
K_{d3} = \frac{[RL][L^*]}{[RLL^*]}  
\]</span></p>
<p><span class="math display">\[
K_{d4} = \frac{[RL^*][L]}{[RLL^*]} \quad \text{(not used)}  
\]</span></p>
<p>Conservation of mass requires that:<br>
<span class="math display">\[
[L^*]_T = [L^*] + [RL^*] + [RLL^*]  
\]</span></p>
<p><span class="math display">\[
[L]_T = [L] + [RL] + [RLL^*]  
\]</span></p>
<p><span class="math display">\[
[R]_T = [R] + [RL^*] + [RL] + [RLL^*]  
\]</span></p>
<p>Thus, concentrations of the complexes are calculated as:<br>
<span class="math display">\[
[RL^*] = \frac{[R]([L^*_T] - [RLL^*])}{K_d^* + [R]} \quad
\]</span></p>
<p><span class="math display">\[
[RL] = \frac{[R]([L_T] - [RLL^*])}{K_d + [R]} \quad  
\]</span></p>
<p><span class="math display">\[
[RLL^*] = \frac{[RL]([L^*_T] - [RL^*])}{K_{d3} + [RL]} \quad  
\]</span></p>
<p>From the above equations, <span class="math inline">\([R]\)</span> can be expressed in a quintic equation:<br>
<span class="math display">\[
a[R]^5 + b[R]^4 + c[R]^3 + d[R]^2 + e[R] + f = 0  
\]</span></p>
<p>The coefficients <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, <span class="math inline">\(c\)</span>, <span class="math inline">\(d\)</span>, <span class="math inline">\(e\)</span>, and <span class="math inline">\(f\)</span> are quite lengthy and can be found in the source code. There is no analytical solution to the quintic equation, but it can be solved numerically.</p>
</section>
<section id="incomplete-competitive-binding---total" class="level3">
<h3 class="anchored" data-anchor-id="incomplete-competitive-binding---total">Incomplete competitive binding - total</h3>
<p>Model name: <code>comp_4st_total</code><br>
References: <a href="https://doi.org/10.1021/bi048233g">Roehrl 2004</a></p>
<p>In analogy to the other models, total binding in the <code>comp_4st_total</code> model is modeled by scaling <span class="math inline">\(K_d\)</span> by a factor of <span class="math inline">\((1 + N)\)</span>.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
<p>© 2024 | Created by <a href="https://quarto.org/">Quarto</a>.</p>
</div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>