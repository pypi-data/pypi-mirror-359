"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9767],{7617:function(e,t,n){n.d(t,{q:function(){return a}});var i=n(24246),r=n(62051);let a=e=>{let{label:t,isDisabled:n,...a}=e;return(0,i.jsx)(r.OK9,{"data-testid":"tab-".concat(t),_selected:{fontWeight:"600",color:"complimentary.500",borderColor:"complimentary.500"},fontSize:a.fontSize,fontWeight:"500",color:"gray.500",isDisabled:n||!1,children:t})};t.Z=e=>{let{data:t,border:n="partial",...l}=e;return(0,i.jsxs)(r.mQc,{colorScheme:"complimentary",...l,children:[(0,i.jsx)(r.tdY,{width:"partial"===n?"max-content":void 0,children:t.map(e=>(0,i.jsx)(a,{label:e.label,isDisabled:e.isDisabled,fontSize:l.fontSize},e.label))}),(0,i.jsx)(r.nPR,{children:t.map(e=>(0,i.jsx)(r.x45,{px:0,"data-testid":"tab-panel-".concat(e.label),children:e.content},e.label))})]})}},97181:function(e,t,n){n.d(t,{d:function(){return d}});var i=n(24246),r=n(62051),a=n(34090),l=n(27378),s=n(46238),o=n(40324);let d=e=>{let{name:t,label:n,labelProps:d,tooltip:c,isRequired:u,layout:h="inline",helperText:x,...p}=e,[m,f,{setValue:g}]=(0,a.U$)(t),v=!!(f.touched&&f.error),[y,j]=(0,l.useState)("");m.value||"tags"!==p.mode&&"multiple"!==p.mode||(m.value=[]),"tags"===p.mode&&"string"==typeof m.value&&(m.value=[m.value]);let b="tags"===p.mode?(e,t)=>e?e.value!==y||m.value.includes(y)?p.optionRender?p.optionRender(e,t):e.label:'Create "'.concat(y,'"'):void 0:p.optionRender||void 0,_=e=>{j(e),p.onSearch&&p.onSearch(e)},C=(e,t)=>{g(e),p.onChange&&p.onChange(e,t)};return"inline"===h?(0,i.jsx)(r.NIc,{isInvalid:v,isRequired:u,children:(0,i.jsxs)(r.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,i.jsx)(o.__,{htmlFor:p.id||t,...d,children:n}):null,(0,i.jsxs)(r.jqI,{align:"center",children:[(0,i.jsxs)(r.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,i.jsx)(r.WPr,{...m,id:p.id||t,"data-testid":"controlled-select-".concat(m.name),...p,optionRender:b,onSearch:"tags"===p.mode?_:void 0,onChange:C,value:m.value||void 0,status:v?"error":void 0}),x&&(0,i.jsx)(r.Q6r,{children:x}),(0,i.jsx)(o.Bc,{isInvalid:v,message:f.error,fieldName:m.name})]}),(0,i.jsx)(s.b,{label:c,className:v?"mt-2 self-start":void 0})]})]})}):(0,i.jsx)(r.NIc,{isInvalid:v,isRequired:u,children:(0,i.jsxs)(r.gCW,{alignItems:"start",children:[(0,i.jsxs)(r.jqI,{align:"center",children:[n?(0,i.jsx)(o.__,{htmlFor:p.id||t,fontSize:"xs",my:0,mr:1,...d,children:n}):null,(0,i.jsx)(s.b,{label:c})]}),(0,i.jsx)(r.WPr,{...m,id:p.id||t,"data-testid":"controlled-select-".concat(m.name),...p,optionRender:b,onSearch:"tags"===p.mode?_:void 0,onChange:C,value:m.value||void 0,status:v?"error":void 0}),x&&(0,i.jsx)(r.Q6r,{style:{marginTop:0},children:x}),(0,i.jsx)(o.Bc,{isInvalid:v,message:f.error,fieldName:m.name})]})})}},46782:function(e,t,n){n.d(t,{j:function(){return a},l:function(){return l}});var i=n(30454),r=n.n(i);let a="#/definitions/FidesDatasetReference",l=e=>{let t=(e,t,n)=>{let i;return(void 0===t||""===t||void 0===t)&&(i="".concat(e," is required")),n===a&&((null==t?void 0:t.includes("."))?t.split(".").length<3&&(i="Dataset reference must include at least three parts"):i="Dataset reference must be dot delimited"),i},n=t=>{var n,i;return null!==(i=null==e?void 0:null===(n=e.required)||void 0===n?void 0:n.includes(t))&&void 0!==i&&i};return{validateField:t,isRequiredField:n,getFieldValidation:(e,i)=>{if(n(e))return e=>{var n;return t(i.title,e,null===(n=i.allOf)||void 0===n?void 0:n[0].$ref)}},preprocessValues:t=>{let n=r()(t);return e&&Object.keys(e.properties).forEach(t=>{var i,r;if((null===(i=e.properties[t].allOf)||void 0===i?void 0:i[0].$ref)===a){let e=null===(r=n.secrets[t])||void 0===r?void 0:r.split(".");e&&(n.secrets[t]={dataset:e.shift(),field:e.join("."),direction:"from"})}"WebsiteSchema"!==e.title||"URL"!==e.properties[t].title||n.secrets[t].startsWith("http://")||n.secrets[t].startsWith("https://")||(n.secrets[t]="https://".concat(n.secrets[t]))}),n}}}},812:function(e,t,n){n.d(t,{D4:function(){return a.D4},MM:function(){return h},Ot:function(){return d},c6:function(){return r},cj:function(){return p},e$:function(){return s},fn:function(){return o},iC:function(){return x},nU:function(){return u},tB:function(){return c}});var i,r,a=n(19043);let l="An unexpected error occurred. Please try again.",s=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if((0,a.Bw)(e)){if((0,a.hE)(e.data))return e.data.detail;if((0,a.cz)(e.data)){var n;let t=null===(n=e.data.detail)||void 0===n?void 0:n[0];return"".concat(null==t?void 0:t.msg,": ").concat(null==t?void 0:t.loc)}if(409===e.status&&(0,a.Dy)(e.data)||404===e.status&&(0,a.XD)(e.data))return"".concat(e.data.detail.error," (").concat(e.data.detail.fides_key,")")}return t};function o(e){return"object"==typeof e&&null!=e&&"status"in e}function d(e){return"object"==typeof e&&null!=e&&"data"in e&&"string"==typeof e.data.detail}function c(e){return"object"==typeof e&&null!=e&&"data"in e&&Array.isArray(e.data.detail)}let u=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{status:500,message:l};if((0,a.oK)(e))return{status:e.originalStatus,message:e.data};if((0,a.Bw)(e)){let{status:n}=e;return{status:n,message:s(e,t.message)}}return t},h=e=>Object.entries(e).map(e=>({value:e[1],label:e[1]}));(i=r||(r={})).GVL="gvl",i.AC="gacp",i.COMPASS="compass";let x={gvl:{label:"GVL",fullName:"Global Vendor List"},gacp:{label:"AC",fullName:"Google Additional Consent List"},compass:{label:"",fullName:""}},p=e=>{let t=e.split(".")[0];return"gacp"===t?"gacp":"gvl"===t?"gvl":"compass"}},14047:function(e,t,n){n.d(t,{H:function(){return a},V:function(){return i.V}});var i=n(84306),r=n(812);let a=()=>{let{errorAlert:e}=(0,i.V)();return{handleError:t=>{let n="An unexpected error occurred. Please try again.";(0,r.Ot)(t)?n=t.data.detail:(0,r.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}}},41337:function(e,t,n){var i=n(24246),r=n(62051);n(27378);var a=n(88337),l=n(16394),s=n(14746);let o=s.Ny+s.iW.get(a.R.WEBSITE),d=e=>void 0!==e.connection_type,c=e=>void 0!==e.encoded_icon,u=e=>(null==e?void 0:e.connection_type)===a.R.WEBSITE,h=e=>(null==e?void 0:e.connection_type)===a.R.SAAS;t.Z=e=>{let{data:t,...n}=e;return(0,i.jsx)(r.Eep,{boxSize:"32px",objectFit:"cover",src:(()=>{var e,n;let i;if(c(t)&&t.encoded_icon)return"data:image/svg+xml;base64,".concat(t.encoded_icon);if(u(t)){let n=null===(e=t.secrets)||void 0===e?void 0:e.url;if(!n)return o;let i=(0,l.ge)(n);return(0,l.tl)(i,100)}if(d(t)){if(h(t)&&(null===(n=t.saas_config)||void 0===n?void 0:n.type)){let e=t.saas_config.type,n=s.LN.get(e);return n?s.Ny+n:s.Ny+s.iW.get(a.R.SAAS)}i=[...s.iW].find(e=>{let[n]=e;return t.connection_type.toString()===n.toString()})}else if(c(t)){let{identifier:e}=t;i=[...s.iW].find(t=>{let[n]=t;return n.toLowerCase()===e.toLowerCase()})}return i?s.Ny+i[1]:s.VD})(),fallbackSrc:u(t)?o:s.VD,alt:(()=>{if(d(t)){var e;return null!==(e=t.name)&&void 0!==e?e:t.key}return c(t)?t.human_readable:t})(),...n})}},1226:function(e,t,n){var i=n(24246);n(27378);var r=n(77213);t.Z=e=>{let{children:t}=e;return(0,i.jsx)(r.Z,{title:"Connections",children:t})}},11274:function(e,t,n){n.d(t,{s:function(){return D}});var i=n(24246),r=n(96356),a=n(62051),l=n(86677),s=n(27378),o=n(16134),d=n(77830),c=n(46420),u=n(14047),h=n(84306),x=n(14207),p=n(16125),m=n(33335),f=n(34090),g=n(46782),v=n(46238);let y=(e,t)=>{let n={...e};return Object.entries(t.properties).forEach(t=>{let[i,r]=t;if("integer"===r.type){let t=r.default?Number(r.default):e[i];n[i]=t||0}else{var a;let t=null!==(a=r.default)&&void 0!==a?a:e[i];n[i]=null!=t?t:null}}),n};var j=e=>{let{data:t,defaultValues:n,isSubmitting:l=!1,onSaveClick:d,onTestConnectionClick:h,testButtonLabel:p="Test integration"}=e,m=(0,s.useRef)(!1),{handleError:j}=(0,u.H)(),{connection:b,connectionOption:_}=(0,o.C)(r.ZZ),[C,k]=(0,x.h2)(),S=e=>{let t;return(void 0===e||""===e)&&(t="Connection Identifier is required"),e&&(0,a.kEn)(e)&&(t="Connection Identifier must be an alphanumeric value"),t},w=(e,t,n)=>{let i;return(void 0===t||""===t)&&(i="".concat(e," is required")),n===g.j&&(t.includes(".")?t.split(".").length<3&&(i="Dataset reference must include at least three parts"):i="Dataset reference must be dot delimited"),i},I=(e,t)=>(0,i.jsx)(a.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:e,minWidth:"150px",children:t}),R=e=>{var t;if((null===(t=e.allOf)||void 0===t?void 0:t[0].$ref)===g.j)return"Enter dataset.collection.field"},z=(e,n)=>{var r;return(0,i.jsx)(f.gN,{id:e,name:e,validate:(null!==(r=t.required)&&void 0!==r&&!!r.includes(e)||"integer"===n.type)&&(e=>{var t;return w(n.title,e,null===(t=n.allOf)||void 0===t?void 0:t[0].$ref)}),children:r=>{var l;let{field:s,form:o}=r;return(0,i.jsxs)(a.NIc,{display:"flex",isRequired:null===(l=t.required)||void 0===l?void 0:l.includes(e),isInvalid:o.errors[e]&&o.touched[e],children:[I(e,n.title),(0,i.jsxs)(a.gCW,{align:"flex-start",w:"inherit",children:["integer"!==n.type&&(0,i.jsx)(a.IIB,{...s,value:s.value||"",placeholder:R(n),autoComplete:"off",color:"gray.700",size:"sm"}),"integer"===n.type&&(0,i.jsxs)(a.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,i.jsx)(a.zuI,{...s,autoComplete:"off"}),(0,i.jsxs)(a.FiK,{children:[(0,i.jsx)(a.WQu,{}),(0,i.jsx)(a.Y_d,{})]})]}),(0,i.jsx)(a.J1D,{children:o.errors[e]})]}),(0,i.jsx)(a.kCb,{alignItems:"center",h:8,ml:2,children:(0,i.jsx)(v.b,{label:n.description})})]})}},e)},W=async()=>{try{await C(b.key).unwrap()}catch(e){j(e)}};return(0,s.useEffect)(()=>(m.current=!0,k.isSuccess&&h(k),()=>{m.current=!1}),[h,k]),(0,i.jsx)(f.J9,{enableReinitialize:!0,initialValues:(()=>{let e={...n};if(null==b?void 0:b.key){var i,r;e.name=null!==(r=b.name)&&void 0!==r?r:"",e.description=b.description,e.instance_key=b.connection_type===c.Rj.SAAS?null===(i=b.saas_config)||void 0===i?void 0:i.fides_key:b.key}return y(e,t)})(),onSubmit:(e,n)=>{let i={...e};Object.keys(t.properties).forEach(n=>{var r;if((null===(r=t.properties[n].allOf)||void 0===r?void 0:r[0].$ref)===g.j){let t=e[n].split(".");i[n]={dataset:t.shift(),field:t.join("."),direction:"from"}}}),d(i,n)},validateOnBlur:!1,validateOnChange:!1,children:e=>(0,i.jsx)(f.l0,{noValidate:!0,children:(0,i.jsxs)(a.gCW,{align:"stretch",gap:"16px",children:[(0,i.jsx)(f.gN,{id:"name",name:"name",validate:e=>w("Name",e),children:t=>{let{field:n}=t;return(0,i.jsxs)(a.NIc,{display:"flex",isRequired:!0,isInvalid:e.errors.name&&e.touched.name,children:[I("name","Name"),(0,i.jsxs)(a.gCW,{align:"flex-start",w:"inherit",mr:"6",children:[(0,i.jsx)(a.IIB,{...n,autoComplete:"off",autoFocus:!0,color:"gray.700",placeholder:"Enter a friendly name for your new ".concat(_.human_readable," connection"),size:"sm","data-testid":"input-name"}),(0,i.jsx)(a.J1D,{children:e.errors.name})]})]})}}),(0,i.jsx)(f.gN,{id:"description",name:"description",children:e=>{let{field:t}=e;return(0,i.jsxs)(a.NIc,{display:"flex",children:[I("description","Description"),(0,i.jsx)(a.gxH,{...t,color:"gray.700",placeholder:"Enter a description for your new ".concat(_.human_readable," connection"),resize:"none",size:"sm",value:t.value||"",mr:"6"})]})}}),(0,i.jsx)(f.gN,{id:"instance_key",name:"instance_key",validate:S,children:t=>{let{field:n}=t;return(0,i.jsxs)(a.NIc,{display:"flex",isRequired:!0,isInvalid:e.errors.instance_key&&e.touched.instance_key,children:[I("instance_key","Connection Identifier"),(0,i.jsxs)(a.gCW,{align:"flex-start",w:"inherit",children:[(0,i.jsx)(a.IIB,{...n,autoComplete:"off",color:"gray.700",isDisabled:!!(null==b?void 0:b.key),placeholder:"A unique identifier for your new ".concat(_.human_readable," connection"),size:"sm"}),(0,i.jsx)(a.J1D,{children:e.errors.instance_key})]}),(0,i.jsx)(a.kCb,{alignItems:"center",h:8,ml:2,children:(0,i.jsx)(v.b,{label:"The fides_key will allow fidesops to associate dataset field references appropriately. Must be a unique alphanumeric value with no spaces (underscores allowed) to represent this connection."})})]})}}),Object.entries(t.properties).map(e=>{let[t,n]=e;return"advanced_settings"===t?null:z(t,n)}),(0,i.jsxs)(a.kCb,{gap:2,children:[(0,i.jsx)(a.wpx,{disabled:!(null==b?void 0:b.key),loading:k.isLoading||k.isFetching,onClick:W,"data-testid":"test-connection-button",children:p}),(0,i.jsx)(a.wpx,{htmlType:"submit",type:"primary",disabled:l,loading:l,children:"Save"})]})]})})})};let b=e=>{let{onConnectionCreated:t,data:n}=e,a=(0,p.I0)(),{errorAlert:l,successAlert:d}=(0,h.V)(),{handleError:f}=(0,u.H)(),[g,v]=(0,s.useState)(!1),{connection:y,connectionOption:j}=(0,o.C)(r.ZZ),[b]=(0,x.pH)(),[_]=(0,x.Du)();return{isSubmitting:g,handleSubmit:async e=>{try{var s;v(!0);let o={access:c.uv.WRITE,connection_type:null==j?void 0:j.identifier,description:e.description,disabled:!1,key:(0,m.E)(e.instance_key),name:e.name},u=await b(o).unwrap();if((null===(s=u.failed)||void 0===s?void 0:s.length)>0)l(u.failed[0].message);else{let s={connection_key:u.succeeded[0].key,secrets:{}};Object.entries(n.properties).forEach(t=>{s.secrets[t[0]]=e[t[0]]});let o=await _(s).unwrap();"failed"===o.test_status?l((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("b",{children:"Message:"})," ",o.msg,(0,i.jsx)("br",{}),(0,i.jsx)("b",{children:"Failure Reason:"})," ",o.failure_reason]})):(a((0,r.lm)(u.succeeded[0])),d("Connector successfully ".concat((null==y?void 0:y.key)?"updated":"added","!")),(null==y?void 0:y.key)||!t||t())}}catch(e){f(e)}finally{v(!1)}},connectionOption:j}},_=e=>{let{data:t,onConnectionCreated:n,onTestConnectionClick:r}=e,{isSubmitting:l,handleSubmit:s,connectionOption:o}=b({onConnectionCreated:n,data:t});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.xuv,{color:"gray.700",fontSize:"14px",h:"80px",children:["Connect to your ",o.human_readable," environment by providing the information below. Once you have saved the form, you may test the integration to confirm that it's working correctly."]}),(0,i.jsx)(j,{data:t,defaultValues:{description:"",instance_key:"",name:""},isSubmitting:l,onSaveClick:s,onTestConnectionClick:r})]})},C={description:"",instance_key:"",name:""},k=e=>{let{data:t,onConnectionCreated:n,onTestEmail:r}=e,{connectionOption:l,isSubmitting:s,handleSubmit:o}=b({onConnectionCreated:n,data:t});return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.xuv,{color:"gray.700",fontSize:"14px",h:"80px",children:["Configure your ",l.human_readable," connector by providing the connector name, description and a test email address. Once you have saved the details, you can click test email to check the format of the email."]}),(0,i.jsx)(j,{data:t,defaultValues:C,isSubmitting:s,onSaveClick:e=>{o(e)},onTestConnectionClick:r,testButtonLabel:"Test email"})]})};var S=n(55484),w=n(27259),I=n(67762),R=e=>{let{defaultValues:t,isSubmitting:n=!1,onSaveClick:s}=e,c=(0,l.useRouter)(),{connection:u,connectionOption:h}=(0,o.C)(r.ZZ);return(0,i.jsx)(f.J9,{initialValues:(()=>{if(null==u?void 0:u.key){var e;t.name=null!==(e=u.name)&&void 0!==e?e:"",t.description=u.description}return t})(),onSubmit:(e,t)=>{s(e,t)},validateOnBlur:!1,validateOnChange:!1,validationSchema:S.Ry().shape({name:S.Z_().required("Name is required")}),children:(0,i.jsx)(f.l0,{noValidate:!0,children:(0,i.jsxs)(a.gCW,{align:"stretch",gap:"16px",children:[(0,i.jsx)(w.Z,{autoFocus:!0,disabled:!!(null==u?void 0:u.key),isRequired:!0,label:"Name",name:"name",placeholder:"Enter a friendly name for your new ".concat(h.human_readable," connection")}),(0,i.jsx)(w.Z,{label:"Description",name:"description",placeholder:"Enter a description for your new ".concat(h.human_readable," connection"),type:"textarea"}),(0,i.jsx)(I.h,{isSubmitting:n,onCancelClick:()=>{c.push(d.JR)}})]})})})};let z=e=>{let{onConnectionCreated:t}=e,n=(0,p.I0)(),{errorAlert:l,successAlert:d}=(0,h.V)(),{handleError:m}=(0,u.H)(),[f,g]=(0,s.useState)(!1),{connection:v,connectionOption:y}=(0,o.C)(r.ZZ),[j]=(0,x.pH)(),b=async(e,i)=>{try{var a;g(!0);let i={access:c.uv.WRITE,connection_type:null==y?void 0:y.identifier,description:e.description,disabled:!1,name:e.name,key:null==v?void 0:v.key},s=await j(i).unwrap();(null===(a=s.failed)||void 0===a?void 0:a.length)>0?l(s.failed[0].message):(n((0,r.lm)(s.succeeded[0])),d("Connector successfully ".concat((null==v?void 0:v.key)?"updated":"added","!")),(null==v?void 0:v.key)||!t||t())}catch(e){m(e)}finally{g(!1)}};return(0,i.jsxs)(a.gCW,{align:"stretch",gap:"16px",children:[(0,i.jsxs)(a.xuv,{color:"gray.700",fontSize:"14px",children:["To begin setting up your new ",y.human_readable," ","connector you must first assign a name to the connector and a description.",(0,i.jsx)("br",{}),(0,i.jsx)("br",{}),"Once you have completed this section you can then progress onto"," ",(0,i.jsx)(a.xvT,{display:"inline-block",fontWeight:"700",children:"DSR customization"})," ","using the menu on the left hand side."]}),(0,i.jsx)(R,{defaultValues:{description:"",name:""},isSubmitting:f,onSaveClick:b})]})},W=e=>{let{data:t,onConnectionCreated:n,onTestConnectionClick:l}=e,d=(0,p.I0)(),{errorAlert:f,successAlert:g}=(0,h.V)(),{handleError:v}=(0,u.H)(),[y,b]=(0,s.useState)(!1),{connection:_,connectionOption:C}=(0,o.C)(r.ZZ),[k]=(0,x.pL)(),[S]=(0,x.pH)(),[w]=(0,x.Du)(),I=async(e,a)=>{try{if(b(!0),_){var l;let n={access:c.uv.WRITE,connection_type:_.connection_type,description:e.description,disabled:!1,key:_.key,name:e.name},a=await S(n).unwrap();if((null===(l=a.failed)||void 0===l?void 0:l.length)>0)f(a.failed[0].message);else{d((0,r.lm)(a.succeeded[0]));let n={connection_key:_.key,secrets:{}};Object.entries(t.properties).forEach(t=>{n.secrets[t[0]]=e[t[0]]});let l=await w(n).unwrap();"failed"===l.test_status?f((0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("b",{children:"Message:"})," ",l.msg,(0,i.jsx)("br",{}),(0,i.jsx)("b",{children:"Failure Reason:"})," ",l.failure_reason]})):g("Connector successfully updated!")}}else{let i={description:e.description,name:e.name,instance_key:(0,m.E)(e.instance_key),saas_connector_type:C.identifier,secrets:{}};Object.entries(t.properties).forEach(t=>{i.secrets[t[0]]=e[t[0]]});let a=await k(i).unwrap();d((0,r.lm)(a.connection)),g("Connector successfully added!"),null==n||n()}}catch(e){v(e)}finally{b(!1)}};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.xuv,{color:"gray.700",fontSize:"14px",h:"80px",children:["Connect to your ",C.human_readable," environment by providing the information below. Once you have saved the form, you may test the integration to confirm that it's working correctly."]}),(0,i.jsx)(j,{data:t,defaultValues:{description:"",instance_key:"",name:""},isSubmitting:y,onSaveClick:I,onTestConnectionClick:l})]})};var Z=n(16394);let E=e=>{var t,n;let{response:l}=e,{connectionOption:s}=(0,o.C)(r.ZZ);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(a.izJ,{color:"gray.100"}),(0,i.jsxs)(a.gCW,{align:"flex-start",mt:"16px",children:[(null===(t=l.data)||void 0===t?void 0:t.test_status)==="succeeded"&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.Ugi,{children:[(0,i.jsxs)(a.X6q,{as:"h5",color:"gray.700",size:"xs",children:["Successfully connected to ",s.human_readable]}),(0,i.jsx)(a.Vp9,{colorScheme:"green",size:"sm",variant:"solid",children:"Success"})]}),(0,i.jsx)(a.xvT,{color:"gray.500",fontSize:"sm",mt:"12px !important",children:(0,Z.p6)(l.fulfilledTimeStamp)}),(0,i.jsx)(a.xuv,{bg:"green.100",border:"1px solid",borderColor:"green.300",color:"green.700",mt:"16px",borderRadius:"6px",children:(0,i.jsxs)(a.Ugi,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,i.jsx)(a.StI,{}),(0,i.jsxs)(a.xuv,{children:[(0,i.jsx)(a.X6q,{as:"h5",color:"green.500",fontWeight:"semibold",size:"xs",children:"Success message:"}),(0,i.jsx)(a.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:l.data.msg})]})]})})]}),(null===(n=l.data)||void 0===n?void 0:n.test_status)==="failed"&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.Ugi,{children:[(0,i.jsxs)(a.X6q,{as:"h5",color:"gray.700",size:"xs",children:["Output error to ",s.human_readable]}),(0,i.jsx)(a.Vp9,{colorScheme:"red",size:"sm",variant:"solid",children:"Error"})]}),(0,i.jsx)(a.xvT,{color:"gray.500",fontSize:"sm",mt:"12px !important",children:(0,Z.p6)(l.fulfilledTimeStamp)}),(0,i.jsx)(a.xuv,{bg:"red.50",border:"1px solid",borderColor:"red.300",color:"red.300",mt:"16px",borderRadius:"6px",children:(0,i.jsxs)(a.Ugi,{alignItems:"flex-start",margin:["14px","17px","14px","17px"],children:[(0,i.jsx)(a.f9v,{}),(0,i.jsxs)(a.xuv,{children:[(0,i.jsx)(a.X6q,{as:"h5",color:"red.500",fontWeight:"semibold",size:"xs",children:"Error message:"}),(0,i.jsx)(a.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:l.data.failure_reason}),(0,i.jsx)(a.xvT,{color:"gray.700",fontSize:"sm",fontWeight:"400",children:l.data.msg})]})]})})]})]})]})},D=e=>{let{onConnectionCreated:t}=e,n=(0,l.useRouter)(),{connectionOption:u}=(0,o.C)(r.ZZ),h=u&&u.type===c.Zi.MANUAL,{data:x,isFetching:p,isLoading:m,isSuccess:f}=(0,r.n3)(u.identifier,{skip:h}),[g,v]=(0,s.useState)(),y=e=>{v(e)},j=(0,s.useCallback)(()=>{n.push(d.JR)},[n]),b=(0,s.useCallback)(()=>{switch(null==u?void 0:u.type){case c.Zi.DATABASE:if(f&&x)return(0,i.jsx)(_,{data:x,onConnectionCreated:t,onTestConnectionClick:y});break;case c.Zi.MANUAL:return(0,i.jsx)(z,{onConnectionCreated:t});case c.Zi.SAAS:if(f&&x)return(0,i.jsx)(W,{data:x,onConnectionCreated:t,onTestConnectionClick:y});break;case c.Zi.EMAIL:if(f&&x)return(0,i.jsx)(k,{data:x,onConnectionCreated:j,onTestEmail:y})}},[null==u?void 0:u.type,x,f,t,j]);return(0,i.jsxs)(a.kCb,{gap:"97px",children:[(0,i.jsxs)(a.gCW,{w:"579px",gap:"16px",align:"stretch",children:[(p||m)&&(0,i.jsx)(a.M5Y,{children:(0,i.jsx)(a.$jN,{})}),b()]}),g&&(0,i.jsxs)(a.Rg9,{in:!0,children:[" ",(0,i.jsx)(a.xuv,{mt:"16px",maxW:"528px",w:"fit-content",children:(0,i.jsx)(E,{response:g})})]})]})}},38212:function(e,t,n){n.d(t,{Z:function(){return j}});var i=n(24246),r=n(14047),a=n(96356),l=n(14207),s=n(62051),o=n(86677),d=n(27378),c=n(16134),u=n(812),h=n(77830),x=n(41966),p=n(84306),m=n(66527),f=n(41207),g=n(39715),v=e=>{let{data:t=[],isSubmitting:n=!1,onSubmit:r,onCancel:a,disabled:l}=e,o=(0,d.useRef)(null),{errorAlert:c}=(0,p.V)(),u=t.length>0?m.ZP.dump(t):void 0,[h,v]=(0,d.useState)(void 0),[y,j]=(0,d.useState)(!1),[b,_]=(0,d.useState)(!u),C=(0,s.qY0)(),{data:k}=(0,x.NR)(),[S,w]=(0,d.useState)([]),I=e=>{m.ZP.load(e,{json:!0}),v(void 0)},R=()=>{let e=o.current.getValue();r(m.ZP.load(e,{json:!0})),w([])};return(0,i.jsxs)(s.kCb,{gap:"97px",children:[(0,i.jsxs)(s.gCW,{align:"stretch",w:"800px",children:[(0,i.jsx)(f.M,{defaultLanguage:"yaml",defaultValue:u,height:"calc(100vh - 526px)",onChange:e=>{try{j(!0),I(e),_(!!(!e||""===e.trim()))}catch(e){(0,f.F)(e)?v(e):c("Could not parse the supplied YAML")}},onMount:(e,t)=>{o.current=e,o.current.focus()},options:{fontFamily:"Menlo",fontSize:13,minimap:{enabled:!0},readOnly:l},theme:"light"}),(0,i.jsxs)(s.Ugi,{justifyContent:"flex-end",pr:6,children:[a&&(0,i.jsx)(s.wpx,{onClick:a,children:"Cancel"}),(0,i.jsx)(s.wpx,{type:"primary",disabled:l||b||!!h||n,loading:n,onClick:()=>{if(k&&k.length){let e=o.current.getValue(),t=k.filter(t=>e.includes("fides_key: ".concat(t.fides_key,"\n"))).map(e=>e.fides_key);if(w(t),t.length){C.onOpen();return}}R()},htmlType:"submit","data-testid":"save-yaml-btn",children:"Save"})]})]}),y&&(b||h)&&(0,i.jsx)(g.Z,{isEmptyState:b,yamlError:h}),(0,i.jsx)(s.cVQ,{isOpen:C.isOpen,onClose:C.onClose,onConfirm:()=>{R(),C.onClose()},title:"Overwrite dataset",message:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.xvT,{children:["You are about to overwrite the dataset",S.length>1?"s":""," ",S.map((e,t)=>{let n=t===S.length-1;return(0,i.jsxs)(d.Fragment,{children:[(0,i.jsx)(s.xvT,{color:"complimentary.500",as:"span",fontWeight:"bold",children:e}),n?".":", "]},e)})]}),(0,i.jsx)(s.xvT,{children:"Are you sure you would like to continue?"})]})})]})};let y=e=>{let{children:t,...n}=e;return(0,i.jsx)(s.xvT,{color:"gray.700",fontSize:"14px",...n,children:t})};var j=()=>{let e=(0,o.useRouter)(),{errorAlert:t,successAlert:n}=(0,r.V)(),{handleError:p}=(0,r.H)(),[m,f]=(0,d.useState)(!1),{connection:g}=(0,c.C)(a.ZZ),{data:j,isFetching:b,isLoading:_,isSuccess:C}=(0,l.Eg)(g.key),[k]=(0,l.Lz)(),[S]=(0,x.EG)(),{data:w,isLoading:I,error:R}=(0,x.NR)(),[z,W]=(0,d.useState)(void 0);(0,d.useEffect)(()=>{j&&j.items.length&&W(j.items[0].ctl_dataset.fides_key)},[j]);let Z=async i=>{var r;let a={connection_key:null==g?void 0:g.key,dataset_pairs:i},l=await k(a).unwrap();(null===(r=l.failed)||void 0===r?void 0:r.length)>0?t(l.failed[0].message):n("Dataset successfully updated!"),e.push(h.JR)},E=async()=>{if(z)try{let e=z;j&&j.items.length&&(e=j.items[0].fides_key);let t=[{fides_key:e,ctl_dataset_fides_key:z}];Z(t)}catch(e){p(e)}},D=async e=>{try{f(!0);let n=Array.isArray(e)?e:[e],i=await S(n);if((0,u.D4)(i)){let e=(0,u.e$)(i.error);t(e);return}let r=n.map(e=>({fides_key:e.fides_key,ctl_dataset_fides_key:e.fides_key}));if(j&&j.items.length){let{items:e}=j;r=e.map((e,t)=>({fides_key:e.fides_key,ctl_dataset_fides_key:n[t].fides_key}))}Z(r)}catch(e){p(e)}finally{f(!1)}},N=""!==z&&void 0!==z;if(b||_||I&&!R)return(0,i.jsx)(s.M5Y,{children:(0,i.jsx)(s.$jN,{})});let F=w&&w.length;return(0,i.jsxs)(s.gCW,{alignItems:"left",gap:4,children:[R&&(0,i.jsx)(y,{color:"red",children:"There was a problem loading existing datasets, please try again."}),(0,i.jsxs)(s.gCW,{alignItems:"flex-start",children:[F&&(0,i.jsx)("div",{children:(0,i.jsx)(s.gCW,{alignSelf:"start",gap:4,children:(0,i.jsxs)(s.xuv,{"data-testid":"dataset-selector-section",children:[(0,i.jsx)(y,{mb:4,children:"Choose a dataset to associate with this connector."}),(0,i.jsxs)(s.Ugi,{children:[(0,i.jsx)(s.WPr,{allowClear:!0,options:w.map(e=>({label:e.fides_key,value:e.fides_key})),className:"w-full",placeholder:"Select",onChange:e=>W(e),value:z,"data-testid":"dataset-selector"}),(0,i.jsx)(s.wpx,{onClick:E,type:"primary",className:"self-start",disabled:!N,"data-testid":"save-dataset-link-btn",children:"Save"})]})]})})}),F&&C&&(null==j?void 0:j.items)&&(0,i.jsx)(s.htM,{plain:!0,children:"or"}),C&&(null==j?void 0:j.items)&&(0,i.jsxs)(s.xuv,{"data-testid":"yaml-editor-section",children:[(0,i.jsx)(y,{mb:4,children:"View your dataset YAML below!"}),(0,i.jsx)(v,{data:j.items.map(e=>e.ctl_dataset),isSubmitting:m,onSubmit:D,disabled:N})]})]})]})}},27259:function(e,t,n){var i=n(24246),r=n(62051),a=n(34090);t.Z=e=>{let{disabled:t=!1,isRequired:n=!1,label:l,placeholder:s,type:o="text",...d}=e,{id:c,autoFocus:u}=d,[h,x]=(0,a.U$)(d);return(0,i.jsxs)(r.NIc,{display:"flex",isRequired:n,isInvalid:!!(x.error&&x.touched),children:[l&&(0,i.jsx)(r.lXp,{color:"gray.900",fontSize:"14px",fontWeight:"semibold",htmlFor:c,minWidth:"150px",children:l}),(0,i.jsxs)(r.gCW,{align:"flex-start",w:"inherit",children:["number"===o&&(0,i.jsxs)(r.Y2U,{allowMouseWheel:!0,color:"gray.700",defaultValue:0,min:0,size:"sm",children:[(0,i.jsx)(r.zuI,{...h,autoComplete:"off",autoFocus:u}),(0,i.jsxs)(r.FiK,{children:[(0,i.jsx)(r.WQu,{}),(0,i.jsx)(r.Y_d,{})]})]}),"text"===o&&(0,i.jsx)(r.IIB,{...h,autoComplete:"off",autoFocus:u,color:"gray.700",isDisabled:t,placeholder:s,size:"sm"}),"textarea"===o&&(0,i.jsx)(r.gxH,{...h,autoComplete:"off",autoFocus:u,color:"gray.700",placeholder:s,resize:"none",size:"sm",value:h.value||""}),(0,i.jsx)(r.J1D,{children:x.error})]})]})}},67762:function(e,t,n){n.d(t,{h:function(){return a}});var i=n(24246),r=n(62051);n(27378);let a=e=>{let{isSubmitting:t=!1,onCancelClick:n}=e;return(0,i.jsxs)(r.hE2,{size:"sm",spacing:"8px",variant:"outline",children:[(0,i.jsx)(r.zxk,{onClick:n,variant:"outline",children:"Cancel"}),(0,i.jsx)(r.zxk,{bg:"primary.800",color:"white",isDisabled:t,isLoading:t,loadingText:"Submitting",size:"sm",variant:"solid",type:"submit",_active:{bg:"primary.500"},_disabled:{opacity:"inherit"},_hover:{bg:"primary.400"},children:"Save"})]})}},50881:function(e,t,n){n.d(t,{Z:function(){return j}});var i=n(24246),r=n(14047),a=n(96356),l=n(14207),s=n(62051),o=n(86677),d=n(27378),c=n(16134),u=n(77830),h=n(34090),x=n(55484),p=n(97181),m=n(57072),f=n(39864),g=n(27259),v=n(67762),y=e=>{let{data:t=[],isSubmitting:n=!1,onSaveClick:a}=e,{isLoading:l}=(0,m.MO)(),d=(0,c.C)(f.qb),y=(0,o.useRouter)(),{errorAlert:j}=(0,r.V)(),b=()=>{y.push(u.JR)};return l?null:(0,i.jsx)(h.J9,{enableReinitialize:!0,initialValues:{fields:t.length>0?t:[{pii_field:"",dsr_package_label:"",data_categories:[]}]},onSubmit:(e,t)=>{if(new Set(e.fields.map(e=>e.pii_field)).size<e.fields.length){j("PII Field must be unique");return}a(e,t)},validateOnBlur:!1,validateOnChange:!1,validationSchema:x.Ry({fields:x.IX().of(x.Ry().shape({pii_field:x.Z_().required("PII Field is required").min(1,"PII Field must have at least one character").max(200,"PII Field has a maximum of 200 characters").label("PII Field"),dsr_package_label:x.Z_().required("DSR Package Label is required").min(1,"DSR Package Label must have at least one character").max(200,"DSR Package Label has a maximum of 200 characters").label("DSR Package Label"),data_categories:x.IX(x.Z_()).label("Data Categories")}))}),children:e=>(0,i.jsx)(h.l0,{style:{marginTop:0},noValidate:!0,children:(0,i.jsx)(s.gCW,{align:"stretch",children:(0,i.jsx)(h.F2,{name:"fields",render:t=>{let{fields:r}=e.values;return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(s.Ugi,{color:"gray.900",flex:"1",fontSize:"14px",fontWeight:"semibold",lineHeight:"20px",mb:"6px",spacing:"24px",children:[(0,i.jsx)(s.xuv,{w:"416px",children:"PII Field"}),(0,i.jsx)(s.xuv,{w:"416px",children:"DSR Package Label"}),(0,i.jsx)(s.xuv,{w:"416px",children:"Data Categories"}),(0,i.jsx)(s.xuv,{visibility:"hidden",children:(0,i.jsx)(s.lr0,{})})]}),(0,i.jsx)(s.xuv,{children:r&&r.length>0?r.map((e,n)=>(0,i.jsxs)(s.Ugi,{mt:n>0?"12px":void 0,spacing:"24px",align:"flex-start",children:[(0,i.jsx)(s.xuv,{minH:"57px",w:"416px",children:(0,i.jsx)(g.Z,{autoFocus:0===n,isRequired:!0,name:"fields.".concat(n,".pii_field")})}),(0,i.jsx)(s.xuv,{minH:"57px",w:"416px",children:(0,i.jsx)(g.Z,{isRequired:!0,name:"fields.".concat(n,".dsr_package_label")})}),(0,i.jsx)(s.xuv,{minH:"57px",w:"416px",children:(0,i.jsx)(p.d,{name:"fields.".concat(n,".data_categories"),options:d.map(e=>({value:e.fides_key,label:e.fides_key})),isRequired:!0,mode:"multiple"})}),(0,i.jsx)(s.xuv,{h:"57px",visibility:n>0?"visible":"hidden",children:(0,i.jsx)(s.lr0,{onClick:()=>t.remove(n),_hover:{cursor:"pointer"}})})]},n)):null}),(0,i.jsx)(s.xvT,{color:"complimentary.500",fontWeight:"medium",fontSize:"sm",mb:"24px !important",mt:"24px !important",onClick:()=>{t.push({pii_field:"",dsr_package_label:"",data_categories:[]})},_hover:{cursor:"pointer"},children:"Add new PII field"}),(0,i.jsx)(v.h,{isSubmitting:n,onCancelClick:b})]})}})})})})},j=()=>{let e=(0,d.useRef)(!1),t=(0,o.useRouter)(),{successAlert:n}=(0,r.V)(),{handleError:h}=(0,r.H)(),[x,p]=(0,d.useState)(!1),[m,f]=(0,d.useState)([]),{connection:g}=(0,c.C)(a.ZZ),{data:v,isFetching:j,isLoading:b,isSuccess:_}=(0,l.QV)(g.key),[C]=(0,l.jF)(),[k]=(0,l._d)(),S=async(e,i)=>{try{p(!0);let i={connection_key:null==g?void 0:g.key,body:{...e}};m.length>0?await k(i).unwrap():await C(i).unwrap(),n("DSR customization ".concat(m.length>0?"updated":"added","!")),t.push(u.JR)}catch(e){h(e)}finally{p(!1)}};return(0,d.useEffect)(()=>(e.current=!0,_&&v&&f(v.fields),()=>{e.current=!1}),[v,_]),(0,i.jsxs)(s.gCW,{align:"stretch",gap:"16px",children:[(0,i.jsx)(s.xuv,{color:"gray.700",fontSize:"14px",w:"572px",children:"Customize your PII fields to create a friendly label name for your privacy request packages. This “Package Label” is the label your user will see in their downloaded package."}),(j||b)&&(0,i.jsx)(s.M5Y,{children:(0,i.jsx)(s.$jN,{})}),e.current&&!b?(0,i.jsx)(y,{data:m,isSubmitting:x,onSaveClick:S}):null]})}},33335:function(e,t,n){n.d(t,{E:function(){return i}});let i=e=>e.toLowerCase().replace(/[ .]/g,"_").replace(/[^a-zA-Z0-9_<>-]/g,"")},19043:function(e,t,n){n.d(t,{Bw:function(){return l},D4:function(){return r},Dy:function(){return o},XD:function(){return d},cz:function(){return c},hE:function(){return s},oK:function(){return a}});var i=n(76649);let r=e=>"error"in e,a=e=>(0,i.Ln)({status:"string"},e)&&"PARSING_ERROR"===e.status,l=e=>(0,i.Ln)({status:"number",data:{}},e),s=e=>(0,i.Ln)({detail:"string"},e),o=e=>(0,i.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),d=e=>(0,i.Ln)({detail:{error:"string",resource_type:"string",fides_key:"string"}},e),c=e=>(0,i.Ln)({detail:[{loc:["string","number"],msg:"string",type:"string"}]},e)}}]);