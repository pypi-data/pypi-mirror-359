(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2369],{1565:function(e,t,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/privacy-requests",function(){return l(22017)}])},35287:function(e,t,l){"use strict";var r=l(24246),i=l(62051),s=l(88038),n=l.n(s);l(27378),t.Z=e=>{let{children:t,title:l,mainProps:s}=e;return(0,r.jsxs)(i.kCb,{"data-testid":l,direction:"column",height:"calc(100vh - 48px)",width:"calc(100vw - 240px)",children:[(0,r.jsxs)(n(),{children:[(0,r.jsxs)("title",{children:["Fides Admin UI - ",l]}),(0,r.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,r.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,r.jsx)(i.kCb,{px:10,py:6,as:"main",overflow:"auto",direction:"column",flex:1,minWidth:0,...s,children:t})]})}},87361:function(e,t,l){"use strict";var r=l(24246),i=l(62051);t.Z=e=>{let{title:t,text:l,onClose:s}=e;return(0,r.jsxs)(i.Ugi,{backgroundColor:"gray.50",border:"1px solid",borderRadius:"md",justifyContent:"space-between",py:4,pr:6,pl:3,"data-testid":"empty-state",gap:2,position:"relative",children:[s&&(0,r.jsx)(i.Two,{boxSize:5,position:"absolute",right:3,top:3,zIndex:1,cursor:"pointer",p:1,onClick:s}),(0,r.jsx)(i.iid,{alignSelf:"start",color:"minos",mt:.5,flexGrow:0}),(0,r.jsxs)(i.kCb,{direction:"column",gap:2,flexGrow:1,children:[(0,r.jsx)(i.X6q,{fontSize:"md",children:t}),(0,r.jsx)(i.xvT,{fontSize:"sm",color:"gray.600",lineHeight:"5",children:l})]})]})}},96718:function(e,t,l){"use strict";l.d(t,{z:function(){return s}});var r=l(24246),i=l(62051);let s=e=>{let{...t}=e,l="multiple"===t.mode;return(0,r.jsx)(i.WPr,{defaultActiveFirstOption:!1,maxTagCount:"responsive",allowClear:!0,dropdownStyle:l?void 0:{width:"auto",minWidth:"200px"},className:"w-auto","data-testid":"filter-select",...t})}},97181:function(e,t,l){"use strict";l.d(t,{d:function(){return d}});var r=l(24246),i=l(62051),s=l(34090),n=l(27378),a=l(46238),o=l(40324);let d=e=>{let{name:t,label:l,labelProps:d,tooltip:u,isRequired:c,layout:p="inline",helperText:m,...h}=e,[x,v,{setValue:y}]=(0,s.U$)(t),f=!!(v.touched&&v.error),[b,j]=(0,n.useState)("");x.value||"tags"!==h.mode&&"multiple"!==h.mode||(x.value=[]),"tags"===h.mode&&"string"==typeof x.value&&(x.value=[x.value]);let _="tags"===h.mode?(e,t)=>e?e.value!==b||x.value.includes(b)?h.optionRender?h.optionRender(e,t):e.label:'Create "'.concat(b,'"'):void 0:h.optionRender||void 0,g=e=>{j(e),h.onSearch&&h.onSearch(e)},C=(e,t)=>{y(e),h.onChange&&h.onChange(e,t)};return"inline"===p?(0,r.jsx)(i.NIc,{isInvalid:f,isRequired:c,children:(0,r.jsxs)(i.rjZ,{templateColumns:l?"1fr 3fr":"1fr",children:[l?(0,r.jsx)(o.__,{htmlFor:h.id||t,...d,children:l}):null,(0,r.jsxs)(i.jqI,{align:"center",children:[(0,r.jsxs)(i.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,r.jsx)(i.WPr,{...x,id:h.id||t,"data-testid":"controlled-select-".concat(x.name),...h,optionRender:_,onSearch:"tags"===h.mode?g:void 0,onChange:C,value:x.value||void 0,status:f?"error":void 0}),m&&(0,r.jsx)(i.Q6r,{children:m}),(0,r.jsx)(o.Bc,{isInvalid:f,message:v.error,fieldName:x.name})]}),(0,r.jsx)(a.b,{label:u,className:f?"mt-2 self-start":void 0})]})]})}):(0,r.jsx)(i.NIc,{isInvalid:f,isRequired:c,children:(0,r.jsxs)(i.gCW,{alignItems:"start",children:[(0,r.jsxs)(i.jqI,{align:"center",children:[l?(0,r.jsx)(o.__,{htmlFor:h.id||t,fontSize:"xs",my:0,mr:1,...d,children:l}):null,(0,r.jsx)(a.b,{label:u})]}),(0,r.jsx)(i.WPr,{...x,id:h.id||t,"data-testid":"controlled-select-".concat(x.name),...h,optionRender:_,onSearch:"tags"===h.mode?g:void 0,onChange:C,value:x.value||void 0,status:f?"error":void 0}),m&&(0,r.jsx)(i.Q6r,{style:{marginTop:0},children:m}),(0,r.jsx)(o.Bc,{isInvalid:f,message:v.error,fieldName:x.name})]})})}},71784:function(e,t,l){"use strict";l.d(t,{DE:function(){return o},I3:function(){return i},kN:function(){return n},qX:function(){return a},rE:function(){return s}});var r=l(46420);let i=[...new Map([[r.q2.APPROVED,"Approved"],[r.q2.AWAITING_EMAIL_SEND,"Awaiting email send"],[r.q2.CANCELED,"Canceled"],[r.q2.COMPLETE,"Completed"],[r.q2.DENIED,"Denied"],[r.q2.ERROR,"Error"],[r.q2.IN_PROCESSING,"In progress"],[r.q2.PENDING,"New"],[r.q2.PAUSED,"Paused"],[r.q2.IDENTITY_UNVERIFIED,"Unverified"],[r.q2.REQUIRES_INPUT,"Requires input"]])].map(e=>{let[t,l]=e;return{label:l,value:t}}),s=new Map([[r.Us.ACCESS,"Access"],[r.Us.ERASURE,"Erasure"],[r.Us.CONSENT,"Consent"],[r.Us.UPDATE,"Update"]]),n=[...s].map(e=>{let[t,l]=e;return{label:l,value:t}}),a={mailgun:"mailgun",twilio_email:"twilio_email",twilio_text:"twilio_text"},o={local:"local",s3:"s3",gcs:"gcs"}},22017:function(e,t,l){"use strict";l.r(t),l.d(t,{default:function(){return eu}});var r,i,s=l(24246),n=l(35287),a=l(62051),o=l(65218),d=l.n(o),u=l(27378),c=l(25980),p=l(19904),m=l(59003),h=l(92222),x=l(86677),v=l(16125),y=l(91317),f=l(14048),b=l(14481),j=l(90867),_=l(16394),g=l(71784),C=l(46420);let q={approved:{colorScheme:"success",label:"Approved"},complete:{label:"Completed",colorScheme:"success"},awaiting_email_send:{label:"Awaiting Email Send",colorScheme:"marble"},denied:{label:"Denied",colorScheme:"warning"},canceled:{label:"Canceled",colorScheme:"marble"},error:{label:"Error",colorScheme:"error"},in_processing:{label:"In Progress",colorScheme:"caution"},paused:{label:"Paused",colorScheme:"marble"},pending:{label:"New",colorScheme:"info"},identity_unverified:{label:"Unverified",colorScheme:"marble"},requires_input:{colorScheme:"alert",label:"Requires Input"}},R=e=>{let{value:t}=e;return(0,s.jsx)(b.A4,{color:q[t].colorScheme,value:q[t].label,"data-testid":"request-status-badge"})},E=e=>{let t,{daysLeft:l,timeframe:r=45,status:i,includeText:n=!1}=e;if(null==l||i===C.q2.COMPLETE||i===C.q2.CANCELED||i===C.q2.DENIED||i===C.q2.IDENTITY_UNVERIFIED)return null;let a=100*l/r;return a<25?t="error":a>=75?t="success":a>=25&&(t="warning"),(0,s.jsx)(b.A4,{value:n?"".concat(l," days left"):l.toString(),color:t})},S=e=>Array.from(new Set(e.filter(e=>Object.values(C.Us).includes(e.action_type)).map(e=>e.action_type))),w=e=>{let{value:t}=e,l=S(t).map(e=>g.rE.get(e));return(0,s.jsx)(b.WP,{value:l,cellState:{isExpanded:!0}})};var I=l(58452),P=l(57526),k=l(66548),A=l(45489);let T=e=>{let{subjectRequest:t,...l}=e,r=(0,a.qY0)(),i=(0,a.qY0)(),n=(0,a.qY0)(),{handleApproveRequest:o,handleDenyRequest:d,handleDeleteRequest:u,isLoading:c}=(0,A.Z)({subjectRequest:t});return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(a.Ugi,{...l,children:["pending"!==t.status?null:(0,s.jsx)(a.wpx,{title:"Approve","aria-label":"Approve",icon:(0,s.jsx)(a.PJP.MCw,{}),onClick:r.onOpen,loading:c,disabled:c,"data-testid":"privacy-request-approve-btn",size:"small"}),"pending"!==t.status?null:(0,s.jsx)(a.wpx,{title:"Deny","aria-label":"Deny",icon:(0,s.jsx)(a.PJP.x8P,{}),onClick:i.onOpen,loading:c,disabled:c,"data-testid":"privacy-request-deny-btn",size:"small"}),(0,s.jsx)(p.ZP,{scopes:[C.Sh.PRIVACY_REQUEST_DELETE],children:(0,s.jsx)(a.wpx,{title:"Delete","aria-label":"Delete",icon:(0,s.jsx)(a.PJP.ZNm,{size:14}),onClick:n.onOpen,loading:c,disabled:c,"data-testid":"privacy-request-delete-btn",size:"small"})})]}),(0,s.jsx)(a.h_i,{children:(0,s.jsx)(P.Z,{isOpen:r.isOpen,isLoading:c,onClose:r.onClose,onApproveRequest:o,subjectRequest:t})}),(0,s.jsx)(a.h_i,{children:(0,s.jsx)(k.Z,{isOpen:i.isOpen,onClose:i.onClose,onDenyRequest:d})}),(0,s.jsx)(I.Z,{isOpen:n.isOpen,onClose:n.onClose,onConfirm:u,message:(0,s.jsx)(a.xvT,{children:"You are about to permanently delete the privacy request. Are you sure you would like to continue?"})})]})};(r=i||(i={})).STATUS="status",r.DAYS_LEFT="due_date",r.SOURCE="source",r.REQUEST_TYPE="request_type",r.SUBJECT_IDENTITY="subject_identity",r.TIME_RECEIVED="created_at",r.CREATED_BY="created_by",r.REVIEWER="reviewer",r.ID="id",r.ACTIONS="actions";let D=(0,h.Cl)(),O=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return[D.accessor(e=>e.status,{id:"status",cell:e=>{let{getValue:t}=e;return(0,s.jsx)(R,{value:t()})},header:e=>(0,s.jsx)(b.Rr,{value:"Status",...e})}),D.accessor(e=>e.days_left,{id:"due_date",cell:e=>{let{row:t,getValue:l}=e;return(0,s.jsx)(E,{daysLeft:l(),timeframe:t.original.policy.execution_timeframe,status:t.original.status})},header:e=>(0,s.jsx)(b.Rr,{value:"Days left",...e})}),...e?[D.accessor(e=>e.source,{id:"source",cell:e=>e.getValue()?(0,s.jsx)(b.A4,{value:e.getValue()}):(0,s.jsx)(b.G3,{value:void 0}),header:e=>(0,s.jsx)(b.Rr,{value:"Source",...e}),enableSorting:!1})]:[],D.accessor(e=>e.policy.rules,{id:"request_type",cell:e=>{let{getValue:t}=e;return(0,s.jsx)(w,{value:t()})},header:e=>(0,s.jsx)(b.Rr,{value:"Request type",...e}),enableSorting:!1}),D.accessor(e=>{var t,l;return(null===(t=e.identity)||void 0===t?void 0:t.email.value)||(null===(l=e.identity)||void 0===l?void 0:l.phone_number.value)||""},{id:"subject_identity",cell:e=>{let{getValue:t}=e;return(0,s.jsx)(b.G3,{value:t()})},header:e=>(0,s.jsx)(b.Rr,{value:"Subject identity",...e}),enableSorting:!1}),D.accessor(e=>e.created_at,{id:"created_at",cell:e=>{let{getValue:t}=e;return(0,s.jsx)(b.G3,{value:(0,_.p6)(t())})},header:e=>(0,s.jsx)(b.Rr,{value:"Time received",...e})}),D.accessor(e=>{var t;return(null===(t=e.reviewer)||void 0===t?void 0:t.username)||""},{id:"reviewer",cell:e=>{let{getValue:t}=e;return(0,s.jsx)(b.G3,{value:t()})},header:e=>(0,s.jsx)(b.Rr,{value:"Reviewed by",...e}),enableSorting:!1}),D.accessor(e=>e.id,{id:"id",cell:e=>{let{getValue:t}=e;return(0,s.jsx)(b.G3,{value:t()})},header:e=>(0,s.jsx)(b.Rr,{value:"Request ID",...e}),enableSorting:!1}),D.display({id:"actions",cell:e=>{let{row:t}=e;return(0,s.jsx)(T,{subjectRequest:t.original})},header:e=>(0,s.jsx)(b.Rr,{value:"Actions",...e}),meta:{disableRowClick:!0}})]},N=e=>{let t=(0,v.v9)(j.dp),l=(0,v.I0)();return{handleStatusChange:t=>{l((0,j.CI)(t)),e()},handleActionTypeChange:t=>{l((0,j.aM)(t)),e()},handleFromChange:t=>{l((0,j.su)(null==t?void 0:t.target.value)),e()},handleToChange:t=>{l((0,j.Ue)(null==t?void 0:t.target.value)),e()},handleClearAllFilters:()=>{l((0,j.Mk)()),e()},...t}};var U=l(96718);let z=e=>{let{onClose:t,onFilterChange:l,...r}=e,{handleStatusChange:i,handleActionTypeChange:n,handleFromChange:o,handleToChange:d,handleClearAllFilters:u,from:c,to:p,status:m,action_type:h}=N(l);return(0,s.jsxs)(a.u_l,{onClose:t,size:"xl",...r,children:[(0,s.jsx)(a.ZAr,{}),(0,s.jsxs)(a.hzk,{children:[(0,s.jsx)(a.xBx,{borderBottomWidth:1,borderBottomColor:"gray.200",children:"All Filters"}),(0,s.jsx)(a.olH,{}),(0,s.jsx)(a.fef,{py:4,sx:{"& label":{mb:0}},children:(0,s.jsxs)(a.Kqy,{gap:4,children:[(0,s.jsxs)(a.Kqy,{children:[(0,s.jsx)(a.lXp,{size:"md",id:"request-date-range-label",children:"Date range"}),(0,s.jsxs)(a.Ugi,{gap:3,children:[(0,s.jsxs)(a.BZy,{size:"sm",flex:1,children:[(0,s.jsx)(a.UiE,{as:"label",htmlFor:"from-date",borderRadius:"md",children:"From"}),(0,s.jsx)(a.IIB,{type:"date",name:"From",value:c,max:p||void 0,onChange:o,borderRadius:"md",id:"from-date","aria-describedby":"request-date-range-label"})]}),(0,s.jsxs)(a.BZy,{size:"sm",flex:1,children:[(0,s.jsx)(a.UiE,{as:"label",htmlFor:"to-date",borderRadius:"md",children:"To"}),(0,s.jsx)(a.IIB,{type:"date",borderRadius:"md",name:"To",value:p,min:c||void 0,onChange:d,id:"to-date","aria-describedby":"request-date-range-label"})]})]})]}),(0,s.jsxs)(a.Kqy,{children:[(0,s.jsx)(a.lXp,{size:"md",htmlFor:"request-status",children:"Status"}),(0,s.jsx)(U.z,{id:"request-status",mode:"multiple",options:g.I3,value:m,onChange:i,"data-testid":"request-status-filter"})]}),(0,s.jsxs)(a.Kqy,{children:[(0,s.jsx)(a.lXp,{size:"md",htmlFor:"request-action-type",children:"Request Type"}),(0,s.jsx)(U.z,{id:"request-action-type",mode:"multiple",options:g.kN,value:h,onChange:n,"data-testid":"request-action-type-filter"})]})]})}),(0,s.jsxs)(a.mzw,{justifyContent:"space-between",children:[(0,s.jsx)(a.wpx,{type:"text",onClick:u,children:"Clear all"}),(0,s.jsx)(a.wpx,{type:"primary",onClick:t,children:"Done"})]})]})]})},F=e=>{let{...t}=e,{plus:l}=(0,c.hz)(),[r,i]=(0,u.useState)(""),n=(0,v.v9)(j.dp),o=(0,v.v9)(y.rK),d=(0,a.pmc)(),p=(0,x.useRouter)(),_=(0,v.I0)(),{PAGE_SIZES:g,pageSize:C,setPageSize:q,onPreviousPageClick:R,isPreviousPageDisabled:E,onNextPageClick:S,isNextPageDisabled:w,startRange:I,endRange:P,pageIndex:k,setTotalPages:A,resetPageIndexToDefault:T}=(0,b.oi)(),{isOpen:D,onOpen:N,onClose:U}=(0,a.qY0)(),{data:F,isLoading:Z,isFetching:M}=(0,j.QA)({...n,page:k,size:C}),{items:V,total:L}=(0,u.useMemo)(()=>{let e=F||{items:[],total:0,pages:0};return A(e.pages),e},[F,A]),Y=(0,u.useCallback)(e=>{_((0,j.mU)(e)),i(e),T()},[_,T,i]),B=async()=>{let e;try{await (0,j.py)({...n,token:o})}catch(t){e=t instanceof Error?t.message:"Unknown error occurred"}e&&d({description:"".concat(e),duration:5e3,status:"error"})},G=e=>{p.push("/privacy-requests/".concat(e))},W=(0,m.b7)({getCoreRowModel:(0,h.sC)(),data:V,columns:(0,u.useMemo)(()=>O(l),[l]),getRowId:e=>"".concat(e.status,"-").concat(e.id),manualPagination:!0,columnResizeMode:"onChange"});return(0,s.jsxs)(a.xuv,{...t,children:[(0,s.jsxs)(b.Q$,{children:[(0,s.jsx)(b.HO,{globalFilter:r,setGlobalFilter:Y,placeholder:"Search by request ID or identity value"}),(0,s.jsxs)(a.Ugi,{alignItems:"center",spacing:2,children:[(0,s.jsx)(a.wpx,{"data-testid":"filter-btn",onClick:N,children:"Filter"}),(0,s.jsx)(a.wpx,{"aria-label":"Export report","data-testid":"export-btn",icon:(0,s.jsx)(f.nM,{ml:"1.5px"}),onClick:B})]}),(0,s.jsx)(a.h_i,{children:(0,s.jsx)(z,{isOpen:D,onClose:U,onFilterChange:T})})]}),Z?(0,s.jsx)(a.xuv,{p:2,borderWidth:1,children:(0,s.jsx)(b.I4,{rowHeight:26,numRows:10})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(b.ZK,{tableInstance:W,onRowClick:e=>G(e.id),onSort:e=>{if(!e){_((0,j.p2)()),T();return}let{id:t,desc:l}=e;_((0,j.PU)(t)),_((0,j.iX)(l?"desc":"asc")),T()}}),(0,s.jsx)(b.s8,{totalRows:L||0,pageSizes:g,setPageSize:q,onPreviousPageClick:R,isPreviousPageDisabled:E||M,onNextPageClick:S,isNextPageDisabled:w||M,startRange:I,endRange:P})]})]})};var Z=l(812),M=l(87361),V=l(46628),L=l(32885),Y=l(34090),B=l(55484),G=l(40324);let W=(e,t)=>null==t?void 0:t.find(t=>t.policy_key===e),K=e=>{var t,l;if(!e)return B.Ry().shape({policy_key:B.Z_().required().label("Request type")});let r=e.custom_privacy_request_fields?Object.entries(e.custom_privacy_request_fields).map(e=>{let[t,l]=e;return{[t]:B.Ry().shape({value:l.required&&!l.hidden?B.Z_().required().label(l.label):B.Z_().nullable()})}}).reduce((e,t)=>({...e,...t}),{}):{};return B.Ry().shape({policy_key:B.Z_().required().label("Request type"),identity:B.Ry().shape({email:(null===(t=e.identity_inputs)||void 0===t?void 0:t.email)==="required"?B.Z_().email().required().label("Email address"):B.Z_().nullable(),phone_number:(null===(l=e.identity_inputs)||void 0===l?void 0:l.phone)==="required"?B.Z_().matches(/^\+?[1-9]\d{1,14}$/,"Phone number must be formatted correctly (e.g. 15555555555)").required().label("Phone number"):B.Z_().matches(/^\+?[1-9]\d{1,14}$/,"Phone number must be formatted correctly (e.g. 15555555555)").nullable()}),custom_privacy_request_fields:B.Ry().shape(r)})};var X=l(97181);let Q={is_verified:!1,policy_key:"",identity:{}},H=e=>{let{identityInputs:t}=e;return t?(0,s.jsxs)(s.Fragment,{children:[t.email?(0,s.jsx)(G.j0,{name:"identity.email",label:"User email address",isRequired:"required"===t.email,variant:"stacked"}):null,t.phone?(0,s.jsx)(G.j0,{name:"identity.phone_number",label:"User phone number",isRequired:"required"===t.phone,variant:"stacked"}):null]}):null},J=e=>{let{customFieldInputs:t}=e;if(!t)return null;let l=Object.entries(t);return(0,s.jsx)(s.Fragment,{children:l.map(e=>{let[t,l]=e;return(0,s.jsx)(G.j0,{name:"custom_privacy_request_fields.".concat(t,".value"),label:l.label,isRequired:!!l.required,variant:"stacked"},t)})})},$=e=>{let{onSubmit:t,onCancel:l,privacyCenterUrl:r}=e,{onCopy:i}=(0,a.VPI)(""),n=(0,a.pmc)();return(0,s.jsx)(Y.J9,{initialValues:{identity:{email:""}},onSubmit:e=>{i("".concat(r,"?email=").concat(encodeURIComponent(e.identity.email))),t(e),n({status:"success",description:"DSR Link Copied!"})},validationSchema:()=>B.Ry().shape({identity:B.Ry().shape({email:B.Z_().email().required().label("Email Address")})}),children:e=>{let{dirty:t,isValid:r}=e;return(0,s.jsx)(Y.l0,{children:(0,s.jsxs)(a.Kqy,{spacing:6,mb:2,children:[(0,s.jsx)(H,{identityInputs:{email:"required"}}),(0,s.jsxs)("div",{className:"flex gap-4 self-end",children:[(0,s.jsx)(a.wpx,{onClick:l,children:"Cancel"}),(0,s.jsx)(a.wpx,{htmlType:"submit",type:"primary",disabled:!t||!r,"data-testid":"submit-btn",icon:(0,s.jsx)(a.xPt,{}),children:"Copy"})]})]})})}})};var ee=e=>{let{onSubmit:t,onCancel:l}=e,{data:r}=(0,j.xv)();return(0,s.jsx)(Y.J9,{initialValues:Q,onSubmit:t,validationSchema:()=>(0,B.Vo)(e=>K(W(e.policy_key,null==r?void 0:r.actions))),children:e=>{var t;let{values:i,dirty:n,isValid:o,isSubmitting:d,setFieldValue:u}=e,c=W(i.policy_key,null==r?void 0:r.actions);return(0,s.jsx)(Y.l0,{children:(0,s.jsxs)(a.Kqy,{spacing:6,mb:2,children:[(0,s.jsx)(X.d,{name:"policy_key",label:"Request type",options:null!==(t=null==r?void 0:r.actions.map(e=>({label:e.title,value:e.policy_key})))&&void 0!==t?t:[],onChange:e=>{let t=W(e,null==r?void 0:r.actions);if(!(null==t?void 0:t.custom_privacy_request_fields)){u("custom_privacy_request_fields",void 0);return}u("custom_privacy_request_fields",Object.entries(t.custom_privacy_request_fields).map(e=>{let[t,l]=e;return{[t]:{label:l.label,value:l.default_value}}}).reduce((e,t)=>({...e,...t}),{}))},layout:"stacked",isRequired:!0}),(0,s.jsx)(H,{identityInputs:null==c?void 0:c.identity_inputs}),(0,s.jsx)(J,{customFieldInputs:null==c?void 0:c.custom_privacy_request_fields}),(0,s.jsx)(G.Xl,{name:"is_verified",label:"I confirm that I have verified this user information"}),(0,s.jsxs)("div",{className:"flex gap-4 self-end",children:[(0,s.jsx)(a.wpx,{onClick:l,children:"Cancel"}),(0,s.jsx)(a.wpx,{htmlType:"submit",type:"primary",disabled:!i.is_verified||!n||!o,loading:d,"data-testid":"submit-btn",children:"Create"})]})]})})}})},et=l(31883);let el=e=>{let{isOpen:t,onClose:l}=e,[r]=(0,j.M6)(),i=(0,a.pmc)(),n=async e=>{let{is_verified:t,...s}=e,n=s.custom_privacy_request_fields?Object.entries(s.custom_privacy_request_fields).map(e=>{let[t,l]=e;return l.value?{[t]:l}:{}}).reduce((e,t)=>({...e,...t}),{}):void 0,a={...s,custom_privacy_request_fields:n},o=await r([a]);(0,et.D4)(o)?i((0,V.Vo)((0,Z.e$)(o.error,"An error occurred while creating this privacy request. Please try again"))):i((0,V.t5)("Privacy request created")),l()};return(0,s.jsxs)(a.u_l,{isOpen:t,onClose:l,size:"2xl",isCentered:!0,children:[(0,s.jsx)(a.ZAr,{}),(0,s.jsxs)(a.hzk,{"data-testid":"submit-request-modal",maxHeight:"80%",overflowY:"auto",children:[(0,s.jsx)(a.xBx,{children:"Create privacy request"}),(0,s.jsx)(a.fef,{children:(0,s.jsxs)(a.Kqy,{spacing:4,children:[(0,s.jsx)(M.Z,{title:"Warning: You are bypassing identity verification",text:"You are bypassing Fides' built-in identity verification step. Please ensure that you are only entering information on behalf of a verified and approved user's privacy request."}),(0,s.jsx)(ee,{onSubmit:n,onCancel:()=>l()})]})})]})]})},er=e=>{let{isOpen:t,onClose:l,privacyCenterUrl:r}=e;return(0,s.jsxs)(a.u_l,{size:"md",isOpen:t,onClose:l,children:[(0,s.jsx)(a.ZAr,{}),(0,s.jsxs)(a.hzk,{children:[(0,s.jsx)(a.xBx,{children:"Create a Privacy Request Link"}),(0,s.jsxs)(a.fef,{children:[(0,s.jsx)(a.Kqy,{spacing:4}),(0,s.jsx)($,{privacyCenterUrl:r,onSubmit:l,onCancel:l})]})]})]})};var ei=()=>{var e;let[t,l]=(0,u.useState)("closed"),r=()=>l("closed"),{data:i}=(0,L.Vh)(),n=(null!==(e=null==i?void 0:i.privacy_center_url)&&void 0!==e?e:"").trim(),o=n.length>0;return(0,s.jsxs)(s.Fragment,{children:[o?(0,s.jsx)(er,{isOpen:"create-link"===t,onClose:r,privacyCenterUrl:n}):null,(0,s.jsx)(el,{isOpen:"submit-request"===t,onClose:r}),(0,s.jsx)(a.S0p.Button,{type:"primary",onClick:()=>l("submit-request"),"data-testid":"submit-request-btn",menu:{items:[{label:"Create request link",key:"create-request-link",icon:(0,s.jsx)(a.xPt,{}),onClick:()=>l("create-link")}]},icon:(0,s.jsx)(a.v4q,{}),disabled:!o,children:"Create request"})]})},es=l(58754),en=l(14047);let ea=()=>{let{errorAlert:e}=(0,en.V)(),[t,l]=(0,u.useState)(!1),[r,i]=(0,u.useState)({count:0,total:0}),[n,o]=(0,u.useState)(!0),d=C.q2.ERROR,{data:c}=(0,j.tE)(),{data:p}=(0,j.QA)({status:[d]},{pollingInterval:15e3,skip:n});return(0,u.useEffect)(()=>{o(!(c&&c.notify_after_failures>0))},[c]),(0,u.useEffect)(()=>{let e=(null==p?void 0:p.total)||0;e>=((null==c?void 0:c.notify_after_failures)||0)&&e>r.total?(i({count:e-r.total,total:e}),l(!0)):l(!1)},[null==p?void 0:p.total,null==c?void 0:c.notify_after_failures,r.total]),{processing:()=>{t&&e((0,s.jsxs)(a.xuv,{children:["DSR automation has failed for"," ",(0,s.jsx)(a.xvT,{as:"span",fontWeight:"semibold",children:r.count})," ","privacy request(s). Please review the event log for further details."]}),void 0,{containerStyle:{maxWidth:"max-content"},duration:null,id:"dsrErrorAlert"})}}},eo=d()(()=>l.e(9676).then(l.bind(l,59676)),{loadableGenerated:{webpack:()=>[59676]},loading:()=>(0,s.jsx)("div",{children:"Loading..."})});var ed=()=>{let{processing:e}=ea(),{plus:t}=(0,c.hz)();return(0,u.useEffect)(()=>{e()},[e]),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(es.Z,{heading:"Privacy Requests",breadcrumbItems:[{title:"All requests"}],rightContent:(0,s.jsxs)(a.vyj,{children:[t&&(0,s.jsx)(p.ZP,{scopes:[C.Sh.PRIVACY_REQUEST_CREATE],children:(0,s.jsx)(ei,{})}),(0,s.jsx)(eo,{})]}),"data-testid":"privacy-requests"}),(0,s.jsx)(F,{})]})},eu=()=>(0,s.jsx)(n.Z,{title:"Privacy Requests",children:(0,s.jsx)(ed,{})})},31883:function(e,t,l){"use strict";l.d(t,{Bw:function(){return r.Bw},D4:function(){return r.D4}});var r=l(19043)},76737:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var l in t)Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}(t,{default:function(){return a},noSSR:function(){return n}});let r=l(51538);l(24246),l(27378);let i=r._(l(21887));function s(e){return{default:(null==e?void 0:e.default)||e}}function n(e,t){return delete t.webpack,delete t.modules,e(t)}function a(e,t){let l=i.default,r={loading:e=>{let{error:t,isLoading:l,pastDelay:r}=e;return null}};e instanceof Promise?r.loader=()=>e:"function"==typeof e?r.loader=e:"object"==typeof e&&(r={...r,...e});let a=(r={...r,...t}).loader;return(r.loadableGenerated&&(r={...r,...r.loadableGenerated},delete r.loadableGenerated),"boolean"!=typeof r.ssr||r.ssr)?l({...r,loader:()=>null!=a?a().then(s):Promise.resolve(s(()=>null))}):(delete r.webpack,delete r.modules,n(l,r))}("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},28438:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"LoadableContext",{enumerable:!0,get:function(){return r}});let r=l(51538)._(l(27378)).default.createContext(null)},21887:function(e,t,l){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return p}});let r=l(51538)._(l(27378)),i=l(28438),s=[],n=[],a=!1;function o(e){let t=e(),l={loading:!0,loaded:null,error:null};return l.promise=t.then(e=>(l.loading=!1,l.loaded=e,e)).catch(e=>{throw l.loading=!1,l.error=e,e}),l}class d{promise(){return this._res.promise}retry(){this._clearTimeouts(),this._res=this._loadFn(this._opts.loader),this._state={pastDelay:!1,timedOut:!1};let{_res:e,_opts:t}=this;e.loading&&("number"==typeof t.delay&&(0===t.delay?this._state.pastDelay=!0:this._delay=setTimeout(()=>{this._update({pastDelay:!0})},t.delay)),"number"==typeof t.timeout&&(this._timeout=setTimeout(()=>{this._update({timedOut:!0})},t.timeout))),this._res.promise.then(()=>{this._update({}),this._clearTimeouts()}).catch(e=>{this._update({}),this._clearTimeouts()}),this._update({})}_update(e){this._state={...this._state,error:this._res.error,loaded:this._res.loaded,loading:this._res.loading,...e},this._callbacks.forEach(e=>e())}_clearTimeouts(){clearTimeout(this._delay),clearTimeout(this._timeout)}getCurrentValue(){return this._state}subscribe(e){return this._callbacks.add(e),()=>{this._callbacks.delete(e)}}constructor(e,t){this._loadFn=e,this._opts=t,this._callbacks=new Set,this._delay=null,this._timeout=null,this.retry()}}function u(e){return function(e,t){let l=Object.assign({loader:null,loading:null,delay:200,timeout:null,webpack:null,modules:null},t),s=null;function o(){if(!s){let t=new d(e,l);s={getCurrentValue:t.getCurrentValue.bind(t),subscribe:t.subscribe.bind(t),retry:t.retry.bind(t),promise:t.promise.bind(t)}}return s.promise()}if(!a){let e=l.webpack?l.webpack():l.modules;e&&n.push(t=>{for(let l of e)if(t.includes(l))return o()})}function u(e,t){!function(){o();let e=r.default.useContext(i.LoadableContext);e&&Array.isArray(l.modules)&&l.modules.forEach(t=>{e(t)})}();let n=r.default.useSyncExternalStore(s.subscribe,s.getCurrentValue,s.getCurrentValue);return r.default.useImperativeHandle(t,()=>({retry:s.retry}),[]),r.default.useMemo(()=>{var t;return n.loading||n.error?r.default.createElement(l.loading,{isLoading:n.loading,pastDelay:n.pastDelay,timedOut:n.timedOut,error:n.error,retry:s.retry}):n.loaded?r.default.createElement((t=n.loaded)&&t.default?t.default:t,e):null},[e,n])}return u.preload=()=>o(),u.displayName="LoadableComponent",r.default.forwardRef(u)}(o,e)}function c(e,t){let l=[];for(;e.length;){let r=e.pop();l.push(r(t))}return Promise.all(l).then(()=>{if(e.length)return c(e,t)})}u.preloadAll=()=>new Promise((e,t)=>{c(s).then(e,t)}),u.preloadReady=e=>(void 0===e&&(e=[]),new Promise(t=>{let l=()=>(a=!0,t());c(n,e).then(l,l)})),window.__NEXT_PRELOADREADY=u.preloadReady;let p=u},65218:function(e,t,l){e.exports=l(76737)}},function(e){e.O(0,[8033,6060,7553,4481,8433,2888,9774,179],function(){return e(e.s=1565)}),_N_E=e.O()}]);