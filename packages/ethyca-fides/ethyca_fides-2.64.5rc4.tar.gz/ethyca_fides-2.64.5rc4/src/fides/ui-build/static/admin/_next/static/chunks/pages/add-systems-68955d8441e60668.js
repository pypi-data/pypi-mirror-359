(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5023],{74245:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/add-systems",function(){return n(5923)}])},69e3:function(e,t,n){"use strict";var s=n(24246),i=n(62051),r=n(91507),a=n.n(r);t.Z=e=>{let{color:t,description:n,title:r,icon:l}=e;return(0,s.jsx)(i.xuv,{borderLeft:"9px solid ".concat(t),borderRadius:"6px",className:a().container,children:(0,s.jsxs)(i.V4A,{className:a().card,"data-testid":"tile-".concat(r),children:[(0,s.jsxs)("div",{className:"mb-1 flex items-center gap-1.5",children:[l,(0,s.jsx)(i.AntTypography.Title,{level:3,children:r})]}),(0,s.jsx)(i.AntTypography.Text,{children:n})]})})}},77867:function(e,t,n){"use strict";var s=n(24246),i=n(62051);t.Z=e=>{let{connected:t,...n}=e,r="red.500";return null==t?r="gray.300":t&&(r="green.500"),(0,s.jsx)(i.xuv,{width:"12px",height:"12px",borderRadius:"6px",backgroundColor:r,...n})}},59301:function(e,t,n){"use strict";var s=n(24246);let{Link:i}=n(62051).AntTypography;t.Z=e=>(0,s.jsx)(i,{target:"_blank",rel:"noopener noreferrer",...e})},77213:function(e,t,n){"use strict";n.d(t,{Z:function(){return h}});var s=n(24246),i=n(62051),r=n(88038),a=n.n(r),l=n(86677);n(27378);var o=n(25980),c=n(90867),d=n(77830),u=()=>{let e=(0,l.useRouter)();return(0,s.jsx)(i.xuv,{bg:"gray.50",border:"1px solid",borderColor:"blue.400",borderRadius:"md",justifyContent:"space-between",p:5,mb:5,mt:5,children:(0,s.jsxs)(i.xuv,{children:[(0,s.jsxs)(i.Kqy,{direction:{base:"column",sm:"row"},justifyContent:"space-between",children:[(0,s.jsx)(i.xvT,{fontWeight:"semibold",children:"Configure your storage and messaging provider"}),(0,s.jsx)(i.wpx,{onClick:()=>{e.push(d.fz)},children:"Configure"})]}),(0,s.jsxs)(i.xvT,{children:["Before Fides can process your privacy requests we need two simple steps to configure your storage and email client."," "]})]})})},h=e=>{let{children:t,title:n,padded:r=!0,mainProps:d}=e,h=(0,o.hz)(),x=(0,l.useRouter)(),m="/privacy-requests"===x.pathname||"/datastore-connection"===x.pathname,p=!(h.flags.privacyRequestsConfiguration&&m),{data:y}=(0,c.JE)(void 0,{skip:p}),{data:j}=(0,c.PW)(void 0,{skip:p}),g=h.flags.privacyRequestsConfiguration&&(!y||!j)&&m;return(0,s.jsxs)(i.kCb,{"data-testid":n,direction:"column",h:"100vh",children:[(0,s.jsxs)(a(),{children:[(0,s.jsxs)("title",{children:["Fides Admin UI - ",n]}),(0,s.jsx)("meta",{name:"description",content:"Privacy Engineering Platform"}),(0,s.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),(0,s.jsxs)(i.kCb,{as:"main",direction:"column",py:r?6:0,px:r?10:0,h:r?"calc(100% - 48px)":"full",flex:1,minWidth:0,overflow:"auto",...d,children:[g?(0,s.jsx)(u,{}):null,t]})]})}},58754:function(e,t,n){"use strict";var s=n(24246),i=n(62051),r=n(70788);t.Z=e=>{let{heading:t,breadcrumbItems:n,isSticky:a=!0,children:l,rightContent:o,style:c,...d}=e;return(0,s.jsxs)("div",{...d,style:a?{position:"sticky",top:"-24px",paddingTop:"24px",paddingBottom:"24px",paddingLeft:"40px",marginLeft:"-40px",paddingRight:"40px",marginRight:"-40px",marginTop:"-24px",left:0,zIndex:20,backgroundColor:"white",...c}:{paddingBottom:"24px",...c},children:[(0,s.jsxs)(i.jqI,{justify:"space-between",children:["string"==typeof t?(0,s.jsx)(i.lQT,{className:n||l?"pb-4":void 0,level:1,"data-testid":"page-heading",children:t}):t,o&&(0,s.jsx)("div",{"data-testid":"page-header-right-content",children:o})]}),!!n&&(0,s.jsx)(r.m,{className:l?"pb-4":void 0,items:n,"data-testid":"page-breadcrumb"}),l]})}},97181:function(e,t,n){"use strict";n.d(t,{d:function(){return c}});var s=n(24246),i=n(62051),r=n(34090),a=n(27378),l=n(46238),o=n(40324);let c=e=>{let{name:t,label:n,labelProps:c,tooltip:d,isRequired:u,layout:h="inline",helperText:x,...m}=e,[p,y,{setValue:j}]=(0,r.U$)(t),g=!!(y.touched&&y.error),[f,v]=(0,a.useState)("");p.value||"tags"!==m.mode&&"multiple"!==m.mode||(p.value=[]),"tags"===m.mode&&"string"==typeof p.value&&(p.value=[p.value]);let b="tags"===m.mode?(e,t)=>e?e.value!==f||p.value.includes(f)?m.optionRender?m.optionRender(e,t):e.label:'Create "'.concat(f,'"'):void 0:m.optionRender||void 0,w=e=>{v(e),m.onSearch&&m.onSearch(e)},C=(e,t)=>{j(e),m.onChange&&m.onChange(e,t)};return"inline"===h?(0,s.jsx)(i.NIc,{isInvalid:g,isRequired:u,children:(0,s.jsxs)(i.rjZ,{templateColumns:n?"1fr 3fr":"1fr",children:[n?(0,s.jsx)(o.__,{htmlFor:m.id||t,...c,children:n}):null,(0,s.jsxs)(i.jqI,{align:"center",children:[(0,s.jsxs)(i.jqI,{vertical:!0,flex:1,className:"mr-2",children:[(0,s.jsx)(i.WPr,{...p,id:m.id||t,"data-testid":"controlled-select-".concat(p.name),...m,optionRender:b,onSearch:"tags"===m.mode?w:void 0,onChange:C,value:p.value||void 0,status:g?"error":void 0}),x&&(0,s.jsx)(i.Q6r,{children:x}),(0,s.jsx)(o.Bc,{isInvalid:g,message:y.error,fieldName:p.name})]}),(0,s.jsx)(l.b,{label:d,className:g?"mt-2 self-start":void 0})]})]})}):(0,s.jsx)(i.NIc,{isInvalid:g,isRequired:u,children:(0,s.jsxs)(i.gCW,{alignItems:"start",children:[(0,s.jsxs)(i.jqI,{align:"center",children:[n?(0,s.jsx)(o.__,{htmlFor:m.id||t,fontSize:"xs",my:0,mr:1,...c,children:n}):null,(0,s.jsx)(l.b,{label:d})]}),(0,s.jsx)(i.WPr,{...p,id:m.id||t,"data-testid":"controlled-select-".concat(p.name),...m,optionRender:b,onSearch:"tags"===m.mode?w:void 0,onChange:C,value:p.value||void 0,status:g?"error":void 0}),x&&(0,s.jsx)(i.Q6r,{style:{marginTop:0},children:x}),(0,s.jsx)(o.Bc,{isInvalid:g,message:y.error,fieldName:p.name})]})})}},14047:function(e,t,n){"use strict";n.d(t,{H:function(){return r},V:function(){return s.V}});var s=n(84306),i=n(812);let r=()=>{let{errorAlert:e}=(0,s.V)();return{handleError:t=>{let n="An unexpected error occurred. Please try again.";(0,i.Ot)(t)?n=t.data.detail:(0,i.tB)(t)&&(n=t.data.detail[0].msg),e(n)}}}},84306:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var s=n(24246),i=n(62051);let r=()=>{let e=(0,i.pmc)();return{errorAlert:(t,n,r)=>{let a={...r,position:(null==r?void 0:r.position)||"top",render:e=>{let{onClose:r}=e;return(0,s.jsxs)(i.bZj,{alignItems:"normal",status:"error","data-testid":"error-alert",children:[(0,s.jsx)(i.zMQ,{}),(0,s.jsxs)(i.xuv,{children:[n&&(0,s.jsx)(i.CdC,{children:n}),(0,s.jsx)(i.XaZ,{children:t})]}),(0,s.jsx)(i.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}};(null==r?void 0:r.id)&&e.isActive(r.id)?e.update(r.id,a):e(a)},successAlert:(t,n,r)=>{let a={...r,position:(null==r?void 0:r.position)||"top",render:e=>{let{onClose:r}=e;return(0,s.jsxs)(i.bZj,{alignItems:"normal",status:"success",variant:"subtle","data-testid":"success-alert",children:[(0,s.jsx)(i.zMQ,{}),(0,s.jsxs)(i.xuv,{children:[n&&(0,s.jsx)(i.CdC,{children:n}),(0,s.jsx)(i.XaZ,{children:t})]}),(0,s.jsx)(i.PZ7,{onClick:r,position:"relative",right:0,size:"sm",top:-1})]})}};(null==r?void 0:r.id)&&e.isActive(r.id)?e.update(r.id,a):e(a)}}}},16220:function(e,t,n){"use strict";n.d(t,{V:function(){return r}});var s=n(25980),i=n(77830);let r=()=>({systemOrDatamapRoute:(0,s.hz)().plus?i.oG:i.So})},57899:function(e,t,n){"use strict";var s=n(24246),i=n(62051),r=n(27378);t.Z=e=>{let{handleConfirm:t,isOpen:n,onClose:a,title:l,message:o,confirmButtonText:c="Continue",cancelButtonText:d="Cancel"}=e,u=(0,r.useRef)(null);return(0,s.jsx)(i.aRR,{isOpen:n,leastDestructiveRef:u,onClose:a,children:(0,s.jsx)(i.dhV,{children:(0,s.jsxs)(i._Tf,{alignItems:"center",textAlign:"center",children:[(0,s.jsx)(i.aNP,{marginTop:3}),(0,s.jsx)(i.fYl,{fontSize:"lg",fontWeight:"bold",children:l}),(0,s.jsx)(i.iPF,{pt:0,children:o}),(0,s.jsxs)(i.xoY,{children:[(0,s.jsx)(i.wpx,{ref:u,onClick:a,size:"large",children:d}),(0,s.jsx)(i.wpx,{onClick:()=>t(),type:"primary",size:"large",className:"ml-3","data-testid":"warning-modal-confirm-btn",children:c})]})]})})})}},70788:function(e,t,n){"use strict";n.d(t,{m:function(){return c}});var s=n(24246),i=n(62051),r=n(79894),a=n.n(r),l=n(27378);let{Text:o}=i.AntTypography,c=e=>{let{items:t,...n}=e,r=(0,l.useMemo)(()=>null==t?void 0:t.map((e,n)=>{let r=n===t.length-1,l={...e},c=l.onClick&&!l.href;return("string"==typeof l.title&&(l.title=(0,s.jsx)(o,{style:{color:"inherit",maxWidth:r?void 0:400},ellipsis:!r,children:l.title})),c)?l.title=(0,s.jsx)(i.wpx,{type:"text",size:"small",icon:l.icon,onClick:l.onClick,className:"ant-breadcrumb-link -mt-px px-1 text-inherit",children:l.title}):(l.icon&&(l.title=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"anticon align-text-bottom",children:l.icon}),l.title]})),l.href&&l.title&&(l.title=(0,s.jsx)(a(),{href:l.href,className:"ant-breadcrumb-link",children:l.title}),delete l.href)),l}),[t]);return(0,s.jsx)(i.zrq,{items:r,...n})}},5923:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return eu}});var s=n(24246),i=n(27378),r=n(16134),a=n(77213),l=n(58754),o=n(15677),c=n(62051),d=n(3124),u=n.n(d),h=n(86677),x=n(25980),m=n(14048),p=n(58452);let y=e=>{let{onCancel:t,onConfirm:n,isOpen:i,onClose:r}=e;return(0,s.jsx)(p.Z,{isOpen:i,onClose:r,onCancel:t,isCentered:!0,title:"Upgrade to choose vendors",message:"To choose vendors and have system information auto-populated using Fides Compass, you will need to upgrade Fides. Meanwhile, you can manually add individual systems using the button below.",cancelButtonText:"Add vendors manually",continueButtonText:"Upgrade",onConfirm:n})};var j=n(77830),g=n(46420),f=n(69e3),v=n(77867),b=n(32885),w=e=>{var t;let{onClick:n}=e,{plus:i,dataFlowScanning:a}=(0,x.hz)(),l=(0,r.C)(b.bw),o=null!==(t=null==l?void 0:l.cluster_health)&&void 0!==t?t:"unknown",d=o===g.wW.HEALTHY;if(!i)return null;let h=null;return a?d||(h="Your cluster appears not to be healthy. Its status is ".concat(o,".")):h="The data flow scanner is not enabled, please check your configuration.",(0,s.jsxs)(c.xuv,{position:"relative",children:[(0,s.jsx)(c.esZ,{title:h,popupVisible:!!h,children:(0,s.jsx)("button",{disabled:!a||!d,type:"button","aria-label":"Data flow scan",className:"text-left",onClick:n,children:(0,s.jsx)(f.Z,{title:"Data flow scan",color:u().FIDESUI_NECTAR,description:"Automatically discover new systems in your Kubernetes infrastructure",icon:(0,s.jsx)(m.pt,{boxSize:6}),"data-testid":"data-flow-scan-btn"})})}),a?(0,s.jsx)(v.Z,{connected:d,title:d?"Cluster is connected and healthy":"Cluster is ".concat(o),position:"absolute",right:-1,top:-1,"data-testid":"cluster-health-indicator"}):null]})},C=n(38764);let k=e=>{let{children:t}=e;return(0,s.jsx)(c.X6q,{as:"h4",size:"xs",fontWeight:"semibold",color:"gray.600",textTransform:"uppercase",mb:4,children:t})};var _=()=>{let e=(0,r.T)(),t=(0,h.useRouter)(),{isOpen:n,onClose:i,onOpen:a}=(0,c.qY0)(),{dictionaryService:l}=(0,x.hz)();return(0,s.jsxs)(c.Kqy,{spacing:9,"data-testid":"add-systems",children:[(0,s.jsxs)(c.Kqy,{spacing:6,maxWidth:"600px",children:[(0,s.jsx)(c.X6q,{as:"h3",size:"md",fontWeight:"semibold",children:"Fides helps you map your systems to manage your privacy"}),(0,s.jsx)(c.xvT,{children:"In Fides, systems describe any services that store or process data for your organization, including third-party APIs, web applications, databases, and data warehouses."}),(0,s.jsx)(c.xvT,{children:"Fides can automatically discover new systems in your AWS infrastructure or Okta accounts. For services not covered by the automated scanners or analog processes, you may also manually add new systems to your map."})]}),(0,s.jsx)(y,{isOpen:n,onConfirm:()=>{window.open("https://fid.es/upgrade-compass")},onCancel:()=>{t.push(j.N5)},onClose:i}),(0,s.jsxs)(c.xuv,{"data-testid":"manual-options",children:[(0,s.jsx)(k,{children:"Manually add systems"}),(0,s.jsxs)(c.MIq,{columns:{base:1,md:2,xl:3},spacing:"4",children:[(0,s.jsx)("button",{className:"flex flex-col text-left",type:"button","aria-label":"Add a system",onClick:()=>{e((0,o.CQ)(C.D.MANUAL)),t.push(j.N5)},"data-testid":"manual-btn",children:(0,s.jsx)(f.Z,{title:"Add a system",color:u().FIDESUI_SANDSTONE,icon:(0,s.jsx)(m.P$,{boxSize:6}),description:"Manually add a system for services not covered by automated scanners"})}),(0,s.jsx)("button",{className:"flex flex-col text-left",type:"button","aria-label":"Add multiple systems",onClick:()=>{l?(e((0,o.CQ)(C.D.MANUAL)),t.push(j.bJ)):a()},"data-testid":"multiple-btn",children:(0,s.jsx)(f.Z,{title:"Add multiple systems",color:u().FIDESUI_OLIVE,icon:(0,s.jsx)(m.P$,{boxSize:6}),description:"Choose vendors and automatically populate system details"})})]})]}),(0,s.jsxs)(c.xuv,{"data-testid":"automated-options",children:[(0,s.jsx)(k,{children:"Automated infrastructure scanning"}),(0,s.jsxs)(c.MIq,{columns:{base:1,md:2,xl:3},spacing:"4",children:[(0,s.jsx)("button",{className:"flex flex-col text-left",type:"button","aria-label":"Scan your infrastructure (AWS)",onClick:()=>{e((0,o.CQ)(g.GC.AWS)),e((0,o.sz)())},"data-testid":"aws-btn",children:(0,s.jsx)(f.Z,{title:"Scan your infrastructure (AWS)",color:u().FIDESUI_TERRACOTTA,description:"Automatically discover new systems in your AWS infrastructure",icon:(0,s.jsx)(m.bj,{boxSize:6})})}),(0,s.jsx)("button",{className:"flex flex-col text-left",type:"button","aria-label":"Scan your Sign On Provider (Okta)",onClick:()=>{e((0,o.CQ)(g.GC.OKTA)),e((0,o.sz)())},"data-testid":"okta-btn",children:(0,s.jsx)(f.Z,{title:"Scan your Sign On Provider (Okta)",color:u().FIDESUI_MINOS,description:"Automatically discover new systems in your Okta infrastructure",icon:(0,s.jsx)(m.tb,{boxSize:6})})}),(0,s.jsx)(w,{onClick:()=>{e((0,o.sz)()),e((0,o.CQ)(C.D.DATA_FLOW))}})]})]})]})},S=n(34090),T=n(55484),A=n(40324),z=n(812),I=n(14047),q=n(97181),N=n(70788),O=n(28416);let F=e=>"system_type"in e,{useGenerateMutation:D}=n(78780).u.injectEndpoints({endpoints:e=>({generate:e.mutation({query:e=>({url:"generate",method:"POST",body:e})})})});var Z=n(59301);let R=e=>{let{message:t}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.izJ,{}),(0,s.jsx)(c.W20,{maxH:"50vh",overflow:"auto",children:(0,s.jsx)(c.xvT,{as:"pre","data-testid":"error-log",children:t})}),(0,s.jsx)(c.izJ,{})]})};var W=e=>{let{error:t,scanType:n=""}=e;return(0,s.jsxs)(c.Kqy,{"data-testid":"scanner-error",spacing:"4",children:[(0,s.jsxs)(c.Ugi,{children:[(0,s.jsx)(c.j8w,{color:"error",children:"Error"}),(0,s.jsx)(c.X6q,{color:"red.500",size:"lg",children:"Failed to Scan"})]}),403===t.status&&n===g.GC.AWS?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.xvT,{"data-testid":"permission-msg",children:"Fides was unable to scan AWS. It appears that the credentials were valid to login but they did not have adequate permission to complete the scan."}),(0,s.jsxs)(c.xvT,{children:["To fix this issue, double check that you have granted"," ",(0,s.jsx)(Z.Z,{href:O.zu,children:"the required permissions"})," ","to these credentials as part of your IAM policy. If you need more help in configuring IAM policies, you can read about them"," ",(0,s.jsx)(Z.Z,{href:"https://docs.aws.amazon.com/IAM/latest/UserGuide/introduction_access-management.html",children:"here"}),"."]})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.xvT,{"data-testid":"generic-msg",children:"Fides was unable to scan your infrastructure. Please ensure your credentials are accurate and inspect the error log below for more details."}),(0,s.jsx)(R,{message:t.message}),(0,s.jsxs)(c.xvT,{children:["If this error does not clarify why scanning failed, please"," ",(0,s.jsx)(Z.Z,{href:O.we,children:"create a new issue"}),"."]})]})]})},E=n(57899);let K=(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.xvT,{color:"gray.500",mb:3,children:"Warning, you are about to cancel the scan!"}),(0,s.jsx)(c.xvT,{color:"gray.500",mb:3,children:"If you cancel scanning, the scanner will stop and no systems will be returned."}),(0,s.jsx)(c.xvT,{color:"gray.500",mb:3,children:"Are you sure you want to cancel?"})]});var U=e=>{let{title:t,onClose:n}=e,{isOpen:i,onOpen:r,onClose:a}=(0,c.qY0)();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.Kqy,{spacing:8,"data-testid":"scanner-loading",children:[(0,s.jsxs)(c.Ugi,{children:[(0,s.jsx)(c.xvT,{alignItems:"center",as:"b",color:"gray.900",display:"flex",fontSize:"xl",children:t}),(0,s.jsx)(c.PZ7,{"data-testid":"close-scan-in-progress",display:"inline-block",onClick:r})]}),(0,s.jsx)(c.Kqy,{alignItems:"center",children:(0,s.jsx)(c.$jN,{thickness:"4px",speed:"0.65s",emptyColor:"gray.200",color:"green.300",size:"xl"})})]}),(0,s.jsx)(E.Z,{isOpen:i,onClose:a,handleConfirm:n,title:"Cancel Scan!",message:K,confirmButtonText:"Yes, Cancel",cancelButtonText:"No, Continue Scanning"})]})};let B={aws_access_key_id:"",aws_secret_access_key:"",aws_session_token:"",region_name:""},P=T.Ry().shape({aws_access_key_id:T.Z_().required().trim().matches(/^\w+$/,"Cannot contain spaces or special characters").label("Access Key ID"),aws_secret_access_key:T.Z_().required().trim().matches(/^[^\s]+$/,"Cannot contain spaces").label("Secret"),aws_session_token:T.Z_().optional().trim().matches(/^[^\s]+$/,"Cannot contain spaces").label("Session Token (for temporary credentials)"),region_name:T.Z_().required().label("Default Region")});var M=()=>{let e=(0,r.C)(o.De),t=(0,r.T)(),{successAlert:n}=(0,I.V)(),[a,l]=(0,i.useState)(),d=e=>{let s=(null!=e?e:[]).filter(F);t((0,o.un)(s)),t((0,o.sz)()),n("Your scan was successfully completed, with ".concat(s.length," new systems detected!"),"Scan Successfully Completed",{isClosable:!0})},u=e=>{l((0,z.nU)(e,{status:500,message:"Our system encountered a problem while connecting to AWS."}))},h=()=>{t((0,o.sz)(2))},[x,{isLoading:m}]=D(),p=async t=>{l(void 0);let n=await x({organization_key:e,generate:{config:t,target:g.GC.AWS,type:g.j.SYSTEMS}});(0,z.D4)(n)?u(n.error):d(n.data.generate_results)};return(0,s.jsx)(S.J9,{initialValues:B,validationSchema:P,onSubmit:p,children:e=>{let{isValid:t,isSubmitting:n,dirty:i}=e;return(0,s.jsx)(S.l0,{"data-testid":"authenticate-aws-form",children:(0,s.jsxs)(c.Kqy,{spacing:10,children:[n?(0,s.jsx)(U,{title:"System scanning in progress",onClose:h}):null,a?(0,s.jsx)(W,{error:a,scanType:"aws"}):null,n||a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.xuv,{children:[(0,s.jsx)(N.m,{className:"mb-4",items:[{title:"Add systems",href:"",onClick:e=>{e.preventDefault(),h()}},{title:"Authenticate AWS Scanner"}]}),(0,s.jsx)(c.xvT,{children:"To use the scanner to inventory systems in AWS, you must first authenticate to your AWS cloud by providing the following information:"})]}),(0,s.jsxs)(c.Kqy,{children:[(0,s.jsx)(A.j0,{name:"aws_access_key_id",label:"Access Key ID",tooltip:"The Access Key ID created by the cloud hosting provider.",isRequired:!0}),(0,s.jsx)(A.j0,{type:"password",name:"aws_secret_access_key",label:"Secret",tooltip:"The secret associated with the Access Key ID used for authentication.",isRequired:!0}),(0,s.jsx)(A.j0,{type:"password",name:"aws_session_token",label:"Session Token",tooltip:"The session token when using temporary credentials."}),(0,s.jsx)(q.d,{name:"region_name",label:"AWS Region",tooltip:"The geographic region of the cloud hosting provider you would like to scan.",options:O.xO,isRequired:!0,placeholder:"Select a region"})]})]}),n?null:(0,s.jsxs)(c.Ugi,{children:[(0,s.jsx)(c.wpx,{onClick:h,children:"Cancel"}),(0,s.jsx)(c.wpx,{htmlType:"submit",type:"primary",disabled:!i||!t,loading:m,"data-testid":"submit-btn",children:"Save and continue"})]})]})})}})};let X={orgUrl:"",token:""},L=T.Ry().shape({orgUrl:T.Z_().required().trim().url().label("URL"),token:T.Z_().required().trim().matches(/^[^\s]+$/,"Cannot contain spaces").label("Token")});var V=()=>{let e=(0,r.C)(o.De),t=(0,r.T)(),{successAlert:n}=(0,I.V)(),[a,l]=(0,i.useState)(),d=e=>{let s=(null!=e?e:[]).filter(F);t((0,o.un)(s)),t((0,o.sz)()),n("Your scan was successfully completed, with ".concat(s.length," new systems detected!"),"Scan Successfully Completed",{isClosable:!0})},u=e=>{l((0,z.nU)(e,{status:500,message:"Our system encountered a problem while connecting to Okta."}))},h=()=>{t((0,o.sz)(2))},[x,{isLoading:m}]=D(),p=async t=>{l(void 0);let n=await x({organization_key:e,generate:{config:t,target:g.GC.OKTA,type:g.j.SYSTEMS}});(0,z.D4)(n)?u(n.error):d(n.data.generate_results)};return(0,s.jsx)(S.J9,{initialValues:X,validationSchema:L,onSubmit:p,children:e=>{let{isValid:t,isSubmitting:n,dirty:i}=e;return(0,s.jsx)(S.l0,{"data-testid":"authenticate-okta-form",children:(0,s.jsxs)(c.Kqy,{spacing:10,children:[n?(0,s.jsx)(U,{title:"System scanning in progress",onClose:h}):null,a?(0,s.jsx)(W,{error:a}):null,n||a?null:(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.xuv,{children:[(0,s.jsx)(N.m,{className:"mb-4",items:[{title:"Add systems",href:"",onClick:e=>{e.preventDefault(),h()}},{title:"Authenticate Okta Scanner"}]}),(0,s.jsx)(c.xvT,{children:"To use the scanner to inventory systems in Okta, you must first authenticate to your Okta account by providing the following information:"})]}),(0,s.jsxs)(c.Kqy,{children:[(0,s.jsx)(A.j0,{name:"orgUrl",label:"Domain",tooltip:"The URL for your organization's account on Okta"}),(0,s.jsx)(A.j0,{name:"token",label:"Okta token",type:"password",tooltip:"The token generated by Okta for your account."})]})]}),n?null:(0,s.jsxs)(c.Ugi,{children:[(0,s.jsx)(c.wpx,{onClick:h,children:"Cancel"}),(0,s.jsx)(c.wpx,{htmlType:"submit",type:"primary",disabled:!i||!t,loading:m,"data-testid":"submit-btn",children:"Save and continue"})]})]})})}})},Y=n(46628),$=n(31883),J=()=>{let e=(0,r.T)(),t=(0,c.pmc)(),[n]=(0,b.J9)(),[a,{data:l}]=(0,b.KW)(),[d,u]=(0,i.useState)(),[h,x]=(0,i.useState)(!1),m=e=>{u((0,z.nU)(e,{status:500,message:"Our system encountered a problem while scanning your infrastructure."}))};(0,i.useEffect)(()=>{(async()=>{let{error:e}=await n();x(!(e&&(0,$.Bw)(e)&&404===e.status));let t=await a({classify:!0});(0,z.D4)(t)&&m(t.error)})()},[a,n]),(0,i.useEffect)(()=>{(async()=>{if(l){let{data:s}=await n(),i=h?(null==s?void 0:s.added_systems)||[]:l.systems;t((0,Y.t5)("Your scan was successfully completed, with ".concat(i.length," new systems detected!"))),e((0,o.un)(i)),e((0,o.sz)())}})()},[l,t,e,h,n]);let p=()=>{e((0,o.sz)(2))};return d?(0,s.jsxs)(c.Kqy,{children:[(0,s.jsx)(W,{error:d}),(0,s.jsx)(c.xuv,{children:(0,s.jsx)(c.wpx,{onClick:p,"data-testid":"cancel-btn",children:"Cancel"})})]}):(0,s.jsx)(U,{title:"Infrastructure scanning in progress",onClose:p})},Q=()=>{let e=(0,r.C)(o.Ll);return(0,s.jsxs)(c.xuv,{w:"40%",children:[e===g.GC.AWS?(0,s.jsx)(M,{}):null,e===g.GC.OKTA?(0,s.jsx)(V,{}):null,e===C.D.DATA_FLOW?(0,s.jsx)(J,{}):null]})},G=n(83265),H=n(46238);let ee=()=>{var e,t;let n=(0,r.T)(),s=e=>{n((0,o.nD)(e)),n((0,o.sz)())},[a]=(0,G.vz)(),[l]=(0,G.$f)(),{data:d,isLoading:u}=(0,G.GQ)(G.Av),[h,x]=(0,i.useState)(!1);(0,i.useEffect)(()=>{!u&&!h&&(null==d?void 0:d.name)&&(null==d?void 0:d.description)&&n((0,o.sz)())},[u,d,n,h]);let m=(0,c.pmc)();return(0,S.TA)({initialValues:{name:null!==(e=null==d?void 0:d.name)&&void 0!==e?e:"",description:null!==(t=null==d?void 0:d.description)&&void 0!==t?t:""},onSubmit:async e=>{var t,n,i;x(!0);let r={name:null!==(t=e.name)&&void 0!==t?t:null==d?void 0:d.name,description:null!==(n=e.description)&&void 0!==n?n:null==d?void 0:d.description,fides_key:null!==(i=null==d?void 0:d.fides_key)&&void 0!==i?i:G.Av,organization_fides_key:G.Av};if(d){let e=await l(r);if((0,z.D4)(e)){m({status:"error",description:(0,z.e$)(e.error)});return}m.closeAll(),s(r)}else{let e=await a(r);if((0,z.D4)(e)){m({status:"error",description:(0,z.e$)(e.error)});return}m.closeAll(),s(r)}},enableReinitialize:!0,validate:e=>{let t={};return e.name||(t.name="Organization name is required"),e.description||(t.description="Organization description is required"),t}})};var et=()=>{let{errors:e,handleBlur:t,handleChange:n,handleSubmit:i,touched:r,values:a,isSubmitting:l}=ee();return(0,s.jsx)(c.m$N.form,{onSubmit:i,w:"40%","data-testid":"organization-info-form",children:(0,s.jsxs)(c.Kqy,{spacing:10,children:[(0,s.jsx)(c.X6q,{as:"h3",size:"lg",children:"Create your Organization"}),(0,s.jsx)("div",{children:"Provide your organization information. This information is used to configure your organization in Fides for data map reporting purposes."}),(0,s.jsx)(c.Kqy,{children:(0,s.jsxs)(c.NIc,{children:[(0,s.jsxs)(c.Kqy,{direction:"row",mb:5,justifyContent:"flex-end",children:[(0,s.jsx)(c.lXp,{w:"100%",children:"Organization name"}),(0,s.jsx)(c.IIB,{type:"text",id:"name",name:"name",focusBorderColor:"gray.700",onChange:n,onBlur:t,value:a.name,isInvalid:r.name&&!!e.name,minW:"65%",w:"65%","data-testid":"input-name"}),(0,s.jsx)(H.b,{label:"The legal name of your organization"})]}),(0,s.jsxs)(c.Kqy,{direction:"row",justifyContent:"flex-end",children:[(0,s.jsx)(c.lXp,{w:"100%",children:"Description"}),(0,s.jsx)(c.IIB,{type:"text",id:"description",name:"description",focusBorderColor:"gray.700",onChange:n,onBlur:t,value:a.description,isInvalid:r.description&&!!e.description,minW:"65%",w:"65%","data-testid":"input-description"}),(0,s.jsx)(H.b,{label:'An explanation of the type of organization and primary activity. For example "Acme Inc. is an e-commerce company that sells scarves."'})]})]})}),(0,s.jsx)(c.wpx,{type:"primary",htmlType:"submit",disabled:!a.name||!a.description,loading:l,"data-testid":"submit-btn",children:"Save and continue"})]})})},en=e=>{let{allColumns:t,selectedColumns:n,onChange:r}=e,a=(0,i.useMemo)(()=>{let e=new Map;return t.forEach(t=>e.set(t.name,!!n.find(e=>e.name===t.name))),e},[t,n]),l=()=>{a.forEach((e,t)=>a.set(t,!1)),r([])},o=e=>{var n;let s=null!==(n=a.get(e.name))&&void 0!==n&&n;a.set(e.name,!s),r(t.filter(e=>a.get(e.name)))};return(0,s.jsx)(c.v2r,{children:e=>{let{onClose:i}=e;return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.j2t,{as:c.wpx,icon:(0,s.jsx)(c.mCO,{}),fontWeight:"normal","data-testid":"column-dropdown",children:"Columns"}),(0,s.jsx)(c.qyq,{children:(0,s.jsxs)(c.xuv,{px:2,children:[(0,s.jsxs)(c.xuv,{display:"flex",justifyContent:"space-between",mb:2,children:[(0,s.jsx)(c.wpx,{size:"small",onClick:l,"data-testid":"column-clear-btn",children:"Clear"}),(0,s.jsx)(c.wpx,{type:"primary",size:"small",onClick:i,"data-testid":"column-done-btn",children:"Done"})]}),(0,s.jsx)(c.cOn,{colorScheme:"complimentary",children:(0,s.jsx)(c.Kqy,{children:t.map(e=>{let t=n.filter(t=>t.name===e.name).length>0;return(0,s.jsx)(c.XZJ,{id:e.name,_hover:{bg:"gray.100"},isChecked:t,onChange:()=>o(e),"data-testid":"checkbox-".concat(e.name),children:e.name},e.name)})})})]})})]})}})},es=n(16220);let ei=(e,t)=>t.split(".").reduce((e,t)=>e?e[t]:void 0,e),er=e=>{let{system:t,attribute:n}=e;if("name"===n)return(0,s.jsx)("label",{htmlFor:"checkbox-".concat(t.fides_key),children:t.name});if("fidesctl_meta.resource_id"===n){var i,r;return(0,s.jsx)(c.xuv,{whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",title:(null===(i=t.fidesctl_meta)||void 0===i?void 0:i.resource_id)||"",children:null===(r=t.fidesctl_meta)||void 0===r?void 0:r.resource_id})}return(0,s.jsx)(s.Fragment,{children:ei(t,n)})},ea=e=>{let{allSystems:t,checked:n,onChange:i,columns:r,tableHeadProps:a}=e,l=e=>{n.indexOf(e)>=0?i(n.filter(t=>t.fides_key!==e.fides_key)):i([...n,e])},o=t.length===n.length;return 0===r.length?(0,s.jsx)(c.xvT,{children:"No columns selected to display"}):(0,s.jsxs)(c.iA_,{size:"sm",sx:{tableLayout:"fixed"},children:[(0,s.jsx)(c.hrZ,{...a,children:(0,s.jsxs)(c.Tr,{children:[(0,s.jsx)(c.Th,{width:"15px",children:(0,s.jsx)(c.XZJ,{colorScheme:"complimentary",title:"Select All",isChecked:o,onChange:e=>{e.target.checked?i(t):i([])},"data-testid":"select-all"})}),r.map(e=>(0,s.jsx)(c.Th,{children:e.name},e.attribute))]})}),(0,s.jsx)(c.p3B,{children:t.map(e=>(0,s.jsxs)(c.Tr,{children:[(0,s.jsx)(c.Td,{children:(0,s.jsx)(c.XZJ,{colorScheme:"complimentary",value:e.fides_key,isChecked:n.indexOf(e)>=0,onChange:()=>l(e),"data-testid":"checkbox-".concat(e.fides_key)})}),r.map(t=>(0,s.jsx)(c.Td,{children:(0,s.jsx)(er,{system:e,attribute:t.attribute})},t.attribute))]},e.fides_key))})]})};var el=n(1315);let eo=[{name:"Name",attribute:"name"},{name:"System type",attribute:"system_type"},{name:"Resource ID",attribute:"fidesctl_meta.resource_id"}];var ec=()=>{let e=(0,r.C)(o.j4),t=(0,r.T)(),n=(0,h.useRouter)(),{systemOrDatamapRoute:a}=(0,es.V)(),{isOpen:l,onOpen:d,onClose:u}=(0,c.qY0)(),[x]=(0,el.dB)(),[m,p]=(0,i.useState)(e),[y,j]=(0,i.useState)(eo),{handleError:g}=(0,I.H)(),f=e=>{n.push(e).then(()=>{t((0,o.mc)())})},v=async()=>{let e=await x(m);return(0,z.D4)(e)?g(e.error):f(a)},b=()=>{t((0,o.sz)(2))},w=(0,s.jsxs)(c.xvT,{color:"gray.500",mb:3,children:["You’re registering ",m.length," of ",e.length," systems available. Do you want to continue with registration or cancel and register all systems now?"]});return(0,s.jsxs)(c.xuv,{maxW:"full",children:[(0,s.jsxs)(c.Kqy,{spacing:10,"data-testid":"scan-results",children:[(0,s.jsx)(N.m,{className:"mb-4",items:[{title:"Add systems",href:"",onClick:e=>{e.preventDefault(),b()}},{title:"Authenticate"},{title:"Scan results"}]}),0===e.length?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(c.xvT,{"data-testid":"no-results",children:"No results were found for your infrastructure scan."}),(0,s.jsx)(c.Ugi,{children:(0,s.jsx)(c.wpx,{onClick:b,"data-testid":"back-btn",children:"Back"})})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(c.xuv,{children:[(0,s.jsx)(c.xvT,{children:"Below are the results of your infrastructure scan. To continue, select the systems you would like registered in your data map and reports."}),(0,s.jsx)(c.xuv,{display:"flex",justifyContent:"end",children:(0,s.jsx)(en,{allColumns:eo,selectedColumns:y,onChange:j})})]}),(0,s.jsx)(ea,{allSystems:e,checked:m,onChange:p,columns:y}),(0,s.jsxs)(c.Ugi,{children:[(0,s.jsx)(c.wpx,{onClick:b,children:"Back"}),(0,s.jsx)(c.wpx,{onClick:()=>{e.length>m.length?d():v()},type:"primary",disabled:0===m.length,"data-testid":"register-btn",children:"Register selected systems"})]})]})]}),(0,s.jsx)(E.Z,{title:"Warning",message:w,handleConfirm:v,isOpen:l,onClose:u})]})},ed=()=>{let e=(0,r.C)(o.xx);return(0,s.jsx)(c.Kqy,{direction:["column","row"],bg:"white",children:(0,s.jsxs)(c.xuv,{display:"flex",justifyContent:"flex-start",w:"100%",children:[1===e?(0,s.jsx)(et,{}):null,2===e?(0,s.jsx)(_,{}):null,3===e?(0,s.jsx)(Q,{}):null,4===e?(0,s.jsx)(c.xuv,{pr:10,children:(0,s.jsx)(ec,{})}):null]})})},eu=()=>{let e=(0,r.T)();return(0,i.useEffect)(()=>{e((0,o.sz)(2))},[e]),(0,s.jsxs)(a.Z,{title:"Add systems",children:[(0,s.jsx)(l.Z,{heading:"Add systems"}),(0,s.jsx)(ed,{})]})}},31883:function(e,t,n){"use strict";n.d(t,{Bw:function(){return s.Bw},D4:function(){return s.D4}});var s=n(19043)},91507:function(e){e.exports={container:"CalloutNavCard_container__DXPJb",card:"CalloutNavCard_card__q_XX6"}},76649:function(e,t,n){"use strict";n.d(t,{Ln:function(){return s}});let s=(e,t)=>r(e,t),i=Symbol("SOME"),r=(e,t)=>"string"==typeof e?e===typeof t:Array.isArray(e)?i in e?e.some(e=>r(e,t)):!!Array.isArray(t)&&(0===e.length||t.every(t=>e.some(e=>r(e,t)))):"object"==typeof t&&null!==t&&Object.entries(e).every(([e,n])=>r(n,t[e]));class a{static narrow(e){return new a(t=>s(e,t))}constructor(e){this.NF=void 0,this.NF=e}satisfied(e){return this.NF(e)}build(e){return e}and(e){let t=this.NF,n=e instanceof a?e.NF:e instanceof Function?e:t=>s(e,t);return new a(e=>t(e)&&n(e))}}new a(e=>!0)}},function(e){e.O(0,[7553,2888,9774,179],function(){return e(e.s=74245)}),_N_E=e.O()}]);