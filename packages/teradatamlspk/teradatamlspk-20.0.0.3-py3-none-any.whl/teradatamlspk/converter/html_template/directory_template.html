<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PySpark Migration Report</title>   
    <style>
        body {
            margin: 0;
            font-family: Consolas, 'Courier New', monospace;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        .left-pane {
            width: 50%;
            overflow: hidden;
            border-right: 1px solid #ccc;
            background: #f4f4f4;
            padding-left: 10px;
            font-size: 14px;
            display: flex;
            flex-direction: column; 
        }

        .right-pane {
            width: 50%;
            overflow-y: auto; 
            padding: 20px;
            background: #fff;
        }

        .head-3 {
            font-size: 14px;
            margin-bottom: 20px;
            color: #555;
            text-align: center;
        }

        .note {
            background-color: #e7f3fe;
            border-left: 6px solid #2196F3;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .note ul {
            font-size: 14px; /* Ensure list items inherit font-size */
        }

        .note li {
            line-height: 1.3; /* Improve readability */
        }

        .dir-list{
            padding-bottom: 10px;
            padding-left: 35px;
            display: flex;
            flex-direction: column;
            flex-grow: 1;
            overflow-y: auto;
            margin-bottom: 0;
        }

        .dir-list li{
            margin-bottom: 10px;
            font-size: 13px;
        }
        .files {
            font-family: 'Courier New', monospace;
            line-height: 1.5;
            padding: 0; /* Remove padding around the highlighted code */
            margin: 0; /* Remove margin around the highlighted code */
        }

        #files-heading {
            text-align: center;
            font-size: 20px;
            color: #444;
            font-weight: bold;
        }

        #files {
            flex-grow: 1;  /* Take the remaining space after the header */
            overflow-y: auto;  /* Enable vertical scrolling */
            display: flex;
            flex-direction: column;
        }

        .fixed-header {
            position: sticky; /* Make it stick to the top */
            padding: 20px 0 10px;
            z-index: 1000; /* Ensure it stays above other content */
            display: flex;
            background: #f4f4f4;
            justify-content: center;
        }
    </style>

</head>
<body>
    <div class="container">
        <!-- Left Pane: Highlighted Code -->
        <div class="left-pane">
            <div class="fixed-header"> 
                <label id="files-heading">Files in the Directory</label>
                <label>
                    <select id="script-selector" style="display: none;">
                        <option value="pyspark">PySpark Script</option>
                        <option value="tdmlspk">teradatamlspk Script</option>
                    </select>
                </label>
            </div>
            <div class="filename-label"></div>
            <div id="files">
                <ol class="dir-list">
                    {{ dir_files }}
                </ol>
            </div>
            
        </div>

        <!-- Right Pane: Custom User Notes Template -->
        <div class="right-pane">
        <button id="back-to-main" style="display: none;">Back to Main Page</button>
            <div id="overview">
                {{ right_pane }}
            </div>
        </div>
    </div>
    <script>

    // Truncate filenames to fit in the column
    const truncateText = (text, maxLength) => {
        // Early return for texts that don't need truncation
        if (text.length <= maxLength) return text;
        
        // Split strategy: 60% of available space for filename start
        // 40% for extension/end part
        const startLength = Math.floor(maxLength * 0.6);
        const endLength = maxLength - startLength + 2;
        
        return `${text.slice(0, startLength)}...${text.slice(-endLength)}`;
    };

    // Main update function that handles DOM measurements
    const updateTruncatedFilenames = () => {
        // Find all elements with the dynamic filename class
        const filenameElements = document.querySelectorAll(".dynamic-filename");
        
        filenameElements.forEach(element => {
            // Get parent container's visible width
            const containerWidth = element.parentElement.clientWidth;
            // Calculate max allowed characters based on width
            const maxVisibleChars = Math.floor(containerWidth * 0.1);
            // Get original text from title attribute (preserve full filename)
            const fullFilename = element.getAttribute("title");
            // Update displayed text with truncated version
            element.textContent = truncateText(fullFilename, maxVisibleChars);
        });
    };

    // Initialize when DOM is ready
    document.addEventListener("DOMContentLoaded", () => {
        // Initial truncation
        updateTruncatedFilenames();
        // Update on window resize.
        window.addEventListener("resize", updateTruncatedFilenames);
    });

    </script>
</body>
</html>