# tinyAgent ğŸ¤– â€“ Product Requirements Document

<context>

## Overview  
TinyAgent is an openâ€‘source Python framework that converts plain Python functions into autonomous, LLMâ€‘powered agents with almost zero boilerplate. It eliminates the friction of orchestration, errorâ€‘handling, and multiâ€‘step planning so developers can focus on business logic instead of agent plumbing. Target users range from solo hackers to enterprise teams that need auditable, selfâ€‘hostable orchestration, all benefiting from tinyAgentâ€™s threeâ€‘line setup and builtâ€‘in tool planner.

## Core Features  
### `@tool` Decorator  
* **What it does:** Turns a Python function into a discoverable tool.  
* **Why itâ€™s important:** Removes boilerplate and captures rich metadata (signature, docâ€‘string).  
* **How it works:** Wraps the function, registers schema, validates args/results.

### `tiny_agent` Runtime  
* **What it does:** Executes a single user query against a list of tools.  
* **Why itâ€™s important:** Enables instant â€œfunctionâ€‘asâ€‘agentâ€ usage.  
* **How it works:** LLM parses intent â†’ maps to tool â†’ validates â†’ executes â†’ returns JSON/text.

### `tiny_chain` Orchestrator  
* **What it does:** Plans and runs multiâ€‘step tool sequences.  
* **Why itâ€™s important:** Solves complex tasks that require search, scraping, summarising, etc.  
* **How it works:** A triage LLM proposes a plan â†’ executes each step â†’ fallback tries all tools.

### Config &Â Env Loader  
* **What it does:** Central YAML + `.env` management layer.  
* **Why itâ€™s important:** Oneâ€‘command portability across local, staging, prod.  
* **How it works:** Reads `config.yml` and env vars â†’ injects keys, model prefs, retry policy.

### StructuredÂ ErrorÂ Handling  
* **What it does:** Provides unified exceptions, retry & backâ€‘off.  
* **Why itâ€™s important:** Prevents silent failures & surfaces actionable logs.  
* **How it works:** Decorators capture errors, classify, retry or bubble up.

### JSONÂ I/O Enforcement  
* **What it does:** Guarantees machineâ€‘readable outputs.  
* **Why itâ€™s important:** Downâ€‘stream systems can reliably parse results.  
* **How it works:** Schemaâ€‘first validation; LLM prompted to comply, else autoâ€‘parses.

## User Experience  
* **Personas**  
  * Solo Dev (Mia) â€“ automates a weekly dataâ€‘cleaning pipeline.  
  * Startup Engineer (Raj) â€“ embeds an AI helper inside a SaaS dashboard.  
  * Research Analyst (Luis) â€“ chains search â†’ scrape â†’ summarise for competitiveâ€‘intel reports.  
* **Key Flows**  
  1. Install â†’ `pip install tiny_agent_os`  
  2. Define Tool â†’ add `@tool` decorator  
  3. Instantiate Agent â†’ `agent = tiny_agent(tools=[...])`  
  4. Run Query â†’ `agent.run("what is 2+2")` or submit task to `tiny_chain`  
  5. Inspect JSON Trace â†’ view structured steps / errors  
* **UI/UX Considerations**  
  * Pure Python API + CLI; optional future web dashboard for tracing  
  * Clear, colourised console logs for each step  
  * Docs site with copyâ€‘paste runnable snippets

</context>

<PRD>

## Technical Architecture  
* **System Components**  
  * Core library (`decorators.py`, `agent.py`, `registry.py`)  
  * Orchestrator (`factory/tiny_chain.py`)  
  * Tool plugâ€‘ins (search, browser, summarise, etc.)  
  * Config manager (YAML + env)  
  * Optional CLI + future web dashboard  
* **Data Models**  
  * `Tool` â€“ `name`, `description`, `signature`, `schema`  
  * `Plan` â€“ ordered list of `{tool, args}`  
  * `Trace` â€“ steps, status, stderr, result  
* **APIs & Integrations**  
  * LLM providers via OpenRouter / OpenAI spec  
  * DuckDuckGoÂ API, custom browser scrape module  
  * Optional vector DB (e.g. Chroma) for retrieval in later phases  
* **Infrastructure Requirements**  
  * Python â‰¥â€¯3.9 runtime  
  * Outbound HTTPS to LLM / search endpoints  
  * Containerâ€‘friendly; no server resources unless hosting a service

## Development Roadmap  
### PhaseÂ 1 â€“ MVP  
* `@tool` decorator & registry  
* `tiny_agent` singleâ€‘tool runtime  
* Basic LLM adapter (OpenRouter)  
* YAML/env config loader  
* Minimal docs & quickâ€‘start examples

### PhaseÂ 2 â€“ Orchestration  
* `tiny_chain` triage agent & fallback logic  
* Builtâ€‘in search, browser & summarise tools  
* Structured tracing & verbose logging  
* CLI commands `tinyagent run`, `tinychain submit`

### PhaseÂ 3 â€“ Ecosystem & DX  
* Plugâ€‘in discovery (entryâ€‘points)  
* Test harness + mock LLMs  
* VSâ€¯Code snippets / templates  
* Documentation overhaul & tutorial site  
* Community examples repository

### PhaseÂ 4 â€“ Advanced Planning & UI  
* Graphâ€‘based planner with memory & vector store  
* Web dashboard for live task inspection  
* Multiâ€‘tenant config layering  
* Enterprise licence automation hooks

### PhaseÂ 5 â€“ Hosting & SaaS Addâ€‘ons  
* Managed API gateway  
* Usage metering & billing hooks  
* OAuth & team workspaces  
* SLA monitoring & alerting

## Logical Dependency Chain  
1. Core decorator & runtime engine  
2. Config & errorâ€‘handling layer  
3. LLM adapter abstraction  
4. Tool registry & unit tests  
5. Orchestrator planner (`tiny_chain`)  
6. CLI interfaces  
7. Tracing & logging  
8. Plugâ€‘in ecosystem  
9. Optional UI & hosting modules

## Risks and Mitigations  
| Risk | Description | Mitigation |  
|------|-------------|-----------|  
| LLM Unreliability | Hallucinations or schema breakage | Strict JSON validation, retry with parserâ€‘based fallback |  
| API Cost Spikes | Heavy usage could incur high LLM fees | Caching, userâ€‘configurable model tier, budget alerts |  
| Singleâ€‘Maintainer Busâ€‘Factor | Project stalls if lead is unavailable | Encourage OSS contributors, CI tests, thorough docs |  
| Competitive Landscape | Large frameworks dominate mindshare | Differentiate via zeroâ€‘boilerplate, speed, permissive licence |  
| Licensing Confusion | BSL may deter some users | Clear FAQs, enterprise path, consider dualâ€‘licence |  

## Appendix  
* Functionâ€¯â†’â€¯Tool JSON schema (v0.7)  
* `config.yml` default with OpenRouter + local LLM stanza  
* Error taxonomy & retry policy spec  
* Future vectorâ€‘store interface proposal

</PRD>

