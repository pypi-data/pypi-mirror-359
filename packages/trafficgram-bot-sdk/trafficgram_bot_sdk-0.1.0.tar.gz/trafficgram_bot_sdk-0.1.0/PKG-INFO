Metadata-Version: 2.4
Name: trafficgram_bot_sdk
Version: 0.1.0
Summary: Trafficgram SDK
Author-email: trafficgram <targetgram.ai@proton.me>
License: MIT
Requires-Python: >=3.10
Description-Content-Type: text/markdown
Requires-Dist: aiogram>=3.20.0.post0
Requires-Dist: asyncio>=3.4.3
Requires-Dist: fastapi>=0.115.13
Requires-Dist: jinja2>=3.1.6
Requires-Dist: pre-commit>=4.2.0
Requires-Dist: pytest>=8.4.1
Requires-Dist: pytest-asyncio>=1.0.0
Requires-Dist: python-dotenv>=1.1.0
Requires-Dist: ruff>=0.12.0
Requires-Dist: uvicorn>=0.34.3


## üöÄ Trafficgram Bot SDK

**Trafficgram Bot SDK** ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ–π –≤—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–π –º–æ–¥—É–ª—å –¥–ª—è Telegram-–±–æ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–∑–≤–æ–ª—è–µ—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–µ–∫–ª–∞–º—É** –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –ø—Ä–∏ –≤—Ö–æ–¥–µ –∏ **–ø—Ä–æ–≤–µ—Ä—è—Ç—å –ø–æ–¥–ø–∏—Å–∫—É** –Ω–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –∫–∞–Ω–∞–ª—ã.

–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è `aiogram 3.x`.

---

## üß© –ß—Ç–æ –¥–µ–ª–∞–µ—Ç SDK

SDK –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç `/start` –∏:

* –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–µ–∫–ª–∞–º—É **–æ–¥–Ω–æ–≥–æ –∏–∑ 3 —Ç–∏–ø–æ–≤**
* –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø–æ–¥–ø–∏—Å–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞ –Ω—É–∂–Ω—ã–µ –∫–∞–Ω–∞–ª—ã
* –ü–æ–≤—Ç–æ—Ä–Ω–æ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç `/start` –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –ø–æ–¥–ø–∏—Å–∫–∏

---

## üì¶ –¢–∏–ø—ã —Ä–µ–∫–ª–∞–º—ã

SDK –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç—Ä–µ–º—è —Ç–∏–ø–∞–º–∏ —Ä–µ–∫–ª–∞–º–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–æ–≤:

| –¢–∏–ø  | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ                  | –ü–æ–≤–µ–¥–µ–Ω–∏–µ                                                   |
| ---- | --------------------------- | ----------------------------------------------------------- |
| `H`  | **Header-—Ä–µ–∫–ª–∞–º–∞**          | –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å—Ä–∞–∑—É –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ. –ú–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–µ–¥–∏–∞/–∫–Ω–æ–ø–∫–∏ |
| `NS` | **–ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞** | –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –∫–∞–Ω–∞–ª—ã, –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞                |
| `OS` | **–û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞**   | –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–∞–ª—å–Ω–µ–π—à–∏–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–æ –ø–æ–¥–ø–∏—Å–∫–∏                   |

---

## üîß –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ SDK –≤ –±–æ—Ç–µ

```python
from config import BOT_TOKEN
from aiogram import Bot, Dispatcher, Router, types, F
from aiogram.client.default import DefaultBotProperties
from aiogram.filters import CommandStart
from aiogram.types import InlineKeyboardMarkup, InlineKeyboardButton
from sdk import SubscriptionMiddleware

# –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞
bot = Bot(BOT_TOKEN, default=DefaultBotProperties(parse_mode="HTML"))
dp = Dispatcher()

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è SDK
middleware = SubscriptionMiddleware(
    sdk_key="your_project_key",   # –ö–ª—é—á –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–∫–ª–∞–º–µ
    max_channels=3,               # –ú–∞–∫—Å–∏–º—É–º –∫–∞–Ω–∞–ª–æ–≤ –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É
    dispatcher=dp
)

# –í–∫–ª—é—á–µ–Ω–∏–µ middleware
dp.message.middleware(middleware)
dp.callback_query.middleware(middleware)

# –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"
middleware.register_check_subscription_handler(dp)
```

---

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –æ–±—ã—á–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤

```python
router_main = Router()

@router_main.message(CommandStart())
async def cmd_start(msg: types.Message):
    keyboard = InlineKeyboardMarkup(inline_keyboard=[
        [InlineKeyboardButton(text="–¢–µ—Å—Ç", callback_data="test_button")]
    ])
    await msg.answer("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ:", reply_markup=keyboard)

@dp.callback_query(F.data == "test_button")
async def test_button_handler(call: types.CallbackQuery):
    await call.answer("–¢–µ—Å—Ç–æ–≤–∞—è –∫–Ω–æ–ø–∫–∞ —Å—Ä–∞–±–æ—Ç–∞–ª–∞!")

dp.include_router(router_main)
```

---

### 3. –ó–∞–ø—É—Å–∫ –±–æ—Ç–∞

```python
async def main():
    await dp.start_polling(bot)

if __name__ == "__main__":
    import asyncio
    asyncio.run(main())
```

---

## ‚úÖ –ß—Ç–æ SDK –¥–µ–ª–∞–µ—Ç —Å–∞–º

* –í—ã–∑—ã–≤–∞–µ—Ç API –∏ –ø–æ–ª—É—á–∞–µ—Ç —Ä–µ–∫–ª–∞–º—É
* –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –∫–æ–Ω—Ç–µ–Ω—Ç –∏ –∫–Ω–æ–ø–∫–∏
* –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å–∫—É (–µ—Å–ª–∏ —Ä–µ–∫–ª–∞–º–∞ —Ç–∏–ø–∞ NS/OS)
* –ü–æ–≤—Ç–æ—Ä–Ω–æ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start` –ø–æ—Å–ª–µ —Ä–µ–∫–ª–∞–º—ã
* –ë–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É –¥–æ –ø–æ–¥–ø–∏—Å–∫–∏ (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
* –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "üîÑ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É"

---

## ‚öôÔ∏è –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤—ã –º–æ–∂–µ—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ:

```python
SubscriptionMiddleware(
    sdk_key="your_key",
    dispatcher=dp,
    not_subscribed_message="–ü–æ–¥–ø–∏—à–∏—Ç–µ—Å—å –Ω–∞ –≤—Å–µ –∫–∞–Ω–∞–ª—ã –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ –±–æ—Ç—É!"
)
```
